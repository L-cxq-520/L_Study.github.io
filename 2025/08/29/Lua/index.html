<!DOCTYPE html>
<html lang="zh-Hans">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="x5-fullscreen" content="true">
<meta name="full-screen" content="yes">
<meta name="theme-color" content="#317EFB" />
<meta content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=0" name="viewport">
<meta name="description" content="LuaLua语法知识概述学习目标  学会搭建Lua开发环境 学会使用Lua语言 热更新方案xLua、toLua的基石  开发环境搭建 ……………  分组、注释和打印分组  VSCode中写Lua脚本可以使用 –#region 和 –#endregion 包括内容进行分组。不过要下载插件    123--#region 我的分组隐藏内容--#endregion  单行注释  在每行语句前使用 – 添">
<meta property="og:type" content="article">
<meta property="og:title" content="Lua">
<meta property="og:url" content="https://l-cxq-520.github.io/L_Study.github.io/2025/08/29/Lua/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="LuaLua语法知识概述学习目标  学会搭建Lua开发环境 学会使用Lua语言 热更新方案xLua、toLua的基石  开发环境搭建 ……………  分组、注释和打印分组  VSCode中写Lua脚本可以使用 –#region 和 –#endregion 包括内容进行分组。不过要下载插件    123--#region 我的分组隐藏内容--#endregion  单行注释  在每行语句前使用 – 添">
<meta property="og:locale">
<meta property="og:image" content="https://l-cxq-520.github.io/L_Study.github.io/img/404.jpg">
<meta property="article:published_time" content="2025-08-29T13:50:24.000Z">
<meta property="article:modified_time" content="2025-12-05T06:22:07.947Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="编程语言">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://l-cxq-520.github.io/L_Study.github.io/img/404.jpg">


<title >Lua</title>

<!-- Favicon -->

    <link href='/L_Study.github.io/img/favicon.svg?v=2.2.4' rel='icon' type='image/png' sizes='16x16' ></link>


    <link href='/L_Study.github.io/img/favicon.svg?v=2.2.4' rel='icon' type='image/png' sizes='32x32' ></link>




<!-- Plugin -->




    
<link rel="stylesheet" href="/L_Study.github.io/css/plugins/bootstrap.row.css">

    
<link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui@4.0/dist/fancybox.css">

    
    




<!-- Icon -->

    
<link rel="stylesheet" href="/L_Study.github.io/css/plugins/font-awesome.min.css">




<!-- Variable -->
<script>window.ASYNC_CONFIG = {"hostname":"l-cxq-520.github.io","author":"John Doe","root":"/L_Study.github.io/","typed_text":["Web Developer"],"theme_version":"2.2.4","theme":{"switch":true,"default":"style-light"},"favicon":{"logo":"/img/favicon.svg","icon16":"/img/favicon.svg","icon32":"/img/favicon.svg","apple_touch_icon":null,"webmanifest":null,"visibilitychange":false,"hidden":"/failure.ico","show_text":"(/≧▽≦/)咦！又好了！","hide_text":"(●—●)喔哟，崩溃啦！"},"i18n":{"placeholder":"搜索文章...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）","author":"本文作者：","copyright_link":"本文链接：","copyright_license_title":"版权声明：","copyright_license_content":"本博客所有文章除特别声明外，均默认采用 undefined 许可协议。","copy_success":"复制成功","copy_failure":"复制失败","open_read_mode":"进入阅读模式","exit_read_mode":"退出阅读模式","notice_outdate_message":"距离上次更新已经 undefined 天了, 文章内容可能已经过时。","sticky":"置顶","just":"刚刚","min":"分钟前","hour":"小时前","day":"天前","month":"个月前"},"swup":false,"plugin":{"flickr_justified_gallery":"https://unpkg.com/flickr-justified-gallery@latest/dist/fjGallery.min.js"},"icons":{"sun":"far fa-sun","moon":"far fa-moon","play":"fas fa-play","email":"far fa-envelope","next":"fas fa-arrow-right","calendar":"far fa-calendar-alt","clock":"far fa-clock","user":"far fa-user","back_top":"fas fa-arrow-up","close":"fas fa-times","search":"fas fa-search","reward":"fas fa-hand-holding-usd","toc_tag":"fas fa-th-list","read":"fas fa-book-reader","arrows":"fas fa-arrows-alt-h","double_arrows":"fas fa-angle-double-down","copy":"fas fa-copy"},"icontype":"font","highlight":{"plugin":"highlighjs","theme":true,"copy":true,"lang":true,"title":"default","height_limit":200},"toc":{"post_title":false},"live_time":{"start_time":"","prefix":"博客已萌萌哒运行 undefined 天"},"danmu":{"enable":false,"el":".trm-banner"}};</script>
<script id="async-page-config">window.PAGE_CONFIG = {"isPost":true,"isHome":false,"postUpdate":"2025-12-05 14:22:07"};</script>

<!-- Theme mode css -->
<link data-swup-theme rel="stylesheet" href="/L_Study.github.io/css/index.css?v=2.2.4" id="trm-switch-style">
<script>
    let defaultMode = ASYNC_CONFIG.theme.default !=='auto' ?  ASYNC_CONFIG.theme.default : (window.matchMedia("(prefers-color-scheme: light)").matches ? 'style-light' : 'style-dark')
    let catchMode = localStorage.getItem('theme-mode') || defaultMode;
    let type = catchMode === 'style-dark' ? 'add' : 'remove';
    document.documentElement.classList[type]('dark')
</script>

<!-- CDN -->


    
    



<!-- Site Analytics -->

 
<meta name="generator" content="Hexo 7.3.0"></head>

<body>

  <!-- app wrapper -->
  <div class="trm-app-frame">

    <!-- page preloader -->
    <div class="trm-preloader">
    <div class="trm-holder">
        <div class="preloader">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
</div>
    <!-- page preloader end -->

    <!-- change mode preloader -->
    <div class="trm-mode-swich-animation-frame">
    <div class="trm-mode-swich-animation">
        <i class="i-sun"><i class="iconfont far fa-sun"></i></i>
        <div class="trm-horizon"></div>
        <i class="i-moon"><i class="iconfont far fa-moon"></i></i>
    </div>
</div>
    <!-- change mode preloader end -->

      <!-- scroll container -->
      <div id="trm-dynamic-content" class="trm-swup-animation">
        <div id="trm-scroll-container" class="trm-scroll-container" style="opacity: 0">
            <!-- top bar -->
            <header class="trm-top-bar">
	<div class="container">
		<div class="trm-left-side">
			<!-- logo -->
<a href="/L_Study.github.io/" class="trm-logo-frame trm-anima-link">
    
        <img alt="logo" src="/L_Study.github.io/img/favicon.svg">
    
    
        <div class="trm-logo-text">
            Unity<span>Study</span>
        </div>
    
</a>
<!-- logo end -->
		</div>
		<div class="trm-right-side">
			<!-- menu -->
<div class="trm-menu">
    <nav>
        <ul>
            
            <li class="menu-item-has-children ">
                <a  href="/L_Study.github.io/" target="">
                    首页
                </a>
                
                <ul>
                    
                    <li>
                        <a  href="/L_Study.github.io/archives2/" target="">
                            archives2
                        </a>
                    </li>
                    
                </ul>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/L_Study.github.io/archives/" target="">
                    归档
                </a>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/L_Study.github.io/categories/" target="">
                    分类
                </a>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/L_Study.github.io/tags/" target="">
                    标签
                </a>
                
            </li>
            
        </ul>
    </nav>
</div>
<!-- menu end -->
			
    <!-- mode switcher place -->
    <div class="trm-mode-switcher-place">
        <div class="trm-mode-switcher">
            <i class="iconfont far fa-sun"></i>
            <input class="tgl tgl-light" id="trm-swich" type="checkbox">
            <label class="trm-swich" for="trm-swich"></label>
            <i class="iconfont far fa-moon"></i>
        </div>
    </div>
    <!-- mode switcher place end -->

			
		</div>
		<div class="trm-menu-btn">
			<span></span>
		</div>
	</div>
</header>
            <!-- top bar end -->

            <!-- body -->
            
<div class="trm-content-start">
    <!-- banner -->
    <div class="trm-banner">
    
    <!-- banner cover -->
    <img style="object-position:top;object-fit:cover;" alt="banner" class="trm-banner-cover" src="/L_Study.github.io/img/banner.png">
    <!-- banner cover end -->
    

    <!-- banner content -->
    <div class="trm-banner-content trm-overlay">
        <div class="container">
            <div class="row">
                
                <div class="col-lg-4"></div>
                
                <div class="col-lg-8">

                    <!-- banner title -->
                    <div class="trm-banner-text ">
                        <div class="trm-label trm-mb-20">
                            NEWS LETTER
                        </div>
                        <h1 class="trm-mb-30 trm-hsmb-font">
                            Lua
                        </h1>

                        
                            <ul class="trm-breadcrumbs trm-label">
                                <li>
                                    <a href="/L_Study.github.io/" class="trm-anima-link">Home</a>
                                </li>
                                <li>
                                    <span>
                                        2025
                                    </span>
                                </li>
                            </ul>
                        
                    </div>
                    <!-- banner title end -->

                    <!-- scroll hint -->
                    <span id="scroll-triger" class="trm-scroll-hint-frame">
                        <div class="trm-scroll-hint"></div>
                        <span class="trm-label">Scroll down</span>
                    </span>
                    <!-- scroll hint end -->

                </div>
            </div>
        </div>
    </div>
    <!-- banner content end -->
</div>
    <!-- banner end -->
    <div class="container">
        <div class="row">
            
                <div class="trm-page-sidebar col-lg-4 hidden-sm">
                    <!-- main card -->
                    <div class="trm-main-card-frame trm-sidebar">
    <div class="trm-main-card"> 
        <!-- card header -->
<div class="trm-mc-header">
    <div class="trm-avatar-frame trm-mb-20">
        <img alt="Avatar" class="trm-avatar" src="/L_Study.github.io/img/Icon.JPG">
    </div>
    <h5 class="trm-name trm-mb-15">
        L
    </h5>
    
        <div class="trm-label">
            I`m
            <span class="trm-typed-text">
                <!-- Words for theme.user.typedText -->
            </span>
        </div>
    
</div>
<!-- card header end -->
        <!-- sidebar social -->

<div class="trm-divider trm-mb-40 trm-mt-40"></div>
<div class="trm-social">
    
        <a href="https://github.com" title="Github" rel="nofollow" target="_blank">
            <i class="iconfont fab fa-github"></i>
        </a>
    
</div>

<!-- sidebar social end -->
        <!-- info -->
<div class="trm-divider trm-mb-40 trm-mt-40"></div>
<ul class="trm-table trm-mb-20">
    
        <li>
            <div class="trm-label">
                Residence:
            </div>
            <div class="trm-label trm-label-light">
                Mars
            </div>
        </li>
    
</ul>
<!-- info end -->

        
    <div class="trm-divider trm-mb-40 trm-mt-40"></div>
    <!-- action button -->
    <div class="text-center">
        <a href="mailto:admin@imalun.com" class="trm-btn">
            联系我
            <i class="iconfont far fa-envelope"></i>
        </a>
    </div>
    <!-- action button end -->

    </div>
</div>
                    <!-- main card end -->
                </div>
            
            <div class="trm-page-content col-lg-8">
                <div id="trm-content" class="trm-content">
                    <div class="trm-post-info row hidden-sm">
    <div class="col-sm-4">
        <div class="trm-card trm-label trm-label-light text-center">
            <i class="iconfont far fa-calendar-alt trm-icon"></i><br>
            08/29
        </div>
    </div>
    <div class="col-sm-4">
        <div class="trm-card trm-label trm-label-light text-center">
            <i class="iconfont far fa-clock trm-icon"></i><br>
            21:50
        </div>
    </div>
    <div class="col-sm-4">
        <div id="post-author" class="trm-card trm-label trm-label-light text-center">
            <i class="iconfont far fa-user trm-icon"></i><br>
            John Doe
        </div>
    </div>
</div>
<div class="trm-card ">
    <article id="article-container" class="trm-publication">
    <h1 id="Lua"><a href="#Lua" class="headerlink" title="Lua"></a>Lua</h1><h2 id="Lua语法知识概述"><a href="#Lua语法知识概述" class="headerlink" title="Lua语法知识概述"></a>Lua语法知识概述</h2><p><strong><font size="4">学习目标</font></strong></p>
<ul>
<li>学会搭建Lua开发环境</li>
<li>学会使用Lua语言</li>
<li>热更新方案xLua、toLua的基石</li>
</ul>
<h2 id="开发环境搭建"><a href="#开发环境搭建" class="headerlink" title="开发环境搭建"></a>开发环境搭建</h2><ul>
<li>……………</li>
</ul>
<h2 id="分组、注释和打印"><a href="#分组、注释和打印" class="headerlink" title="分组、注释和打印"></a>分组、注释和打印</h2><p><strong><font size="4">分组</font></strong></p>
<ul>
<li>VSCode中写Lua脚本可以使用 –#region 和 –#endregion 包括内容进行分组。不过要下载插件</li>
</ul>
<img src="/L_Study.github.io/2025/08/29/Lua/Lua_VsCode_Lua%E6%8F%92%E4%BB%B6.png" class="" title="Lua_VsCode_Lua插件"  data-tag='post-image' onload='this.onload=null;this.style.opacity=1;' onerror='this.onerror=null;this.src="/L_Study.github.io/img/404.jpg"'>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--#region 我的分组</span></span><br><span class="line">隐藏内容</span><br><span class="line"><span class="comment">--#endregion</span></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">单行注释</font></strong></p>
<ul>
<li>在每行语句前使用 – 添加单行注释。</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 单行注释</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">多行注释</font></strong></p>
<ul>
<li>多行注释有三种方式 –[[ ]], –[[ ]]–, –[[ –]].</li>
</ul>
<p><strong><font size="3">第一种</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">第一种</span></span><br><span class="line"><span class="comment">多行</span></span><br><span class="line"><span class="comment">注释</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">第二种</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">第二种</span></span><br><span class="line"><span class="comment">多行</span></span><br><span class="line"><span class="comment">注释</span></span><br><span class="line"><span class="comment">]]</span><span class="comment">--</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">第三种</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">第三种</span></span><br><span class="line"><span class="comment">多行</span></span><br><span class="line"><span class="comment">注释</span></span><br><span class="line"><span class="comment">--]]</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="4">print打印函数</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;HelloWorld&quot;</span>)<span class="comment">--HelloWorld</span></span><br><span class="line"><span class="comment">--lua语句 可以省略分号</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Lua欢迎你&quot;</span>)<span class="comment">--Lua欢迎你</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">打印中文乱码问题</font></strong></p>
<ul>
<li>可能是字符格式问题，修改设置路径为exe，并且改编码格式为gbk。当然不一定有用。</li>
<li>具体上网查询，不多叙述。</li>
</ul>
<h2 id="简单类型变量"><a href="#简单类型变量" class="headerlink" title="简单类型变量"></a>简单类型变量</h2><p><strong><font size="4">简单类型变量的声明与赋值</font></strong></p>
<p><strong><font size="3">lua中的简单变量类型有：</font></strong></p>
<ul>
<li>nil 空型</li>
<li>number 数值型</li>
<li>string 字符串型</li>
<li>boolean 布尔型</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a = <span class="literal">nil</span>   <span class="comment">--nil</span></span><br><span class="line">a = <span class="number">1</span>     <span class="comment">--number</span></span><br><span class="line">a = <span class="string">&quot;123&quot;</span> <span class="comment">--string</span></span><br><span class="line">a = <span class="literal">false</span> <span class="comment">--boolean</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>lua中所有的变量申明都不需要申明变量类型，lua会自动的判断类型，类似C#里面的var。<br>lua中的一个变量可以随便赋值，lua会自动识别类型。</p>
</blockquote>
<ul>
<li>lua中使用没有声明过的变量，不会报错，默认值是nil。</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(b) <span class="comment">--nil</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="4">nil空型变量</font></strong></p>
<ul>
<li>nil 有点类似 C#中的null。</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">c = <span class="literal">nil</span></span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment">-- nil</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">number数值型变量</font></strong></p>
<ul>
<li>number 所有的数值都是number。</li>
</ul>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">d = <span class="number">1</span></span><br><span class="line">print(d) -- <span class="number">1</span></span><br><span class="line">e = <span class="number">1.2</span></span><br><span class="line">print(e) -- <span class="number">1.2</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">string字符串型变量</font></strong></p>
<ul>
<li>字符串的赋值使用单引号或者双引号包裹都可以。</li>
<li>lua中没有char变量。</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">f = <span class="string">&quot;12312&quot;</span></span><br><span class="line"><span class="built_in">print</span>(f) <span class="comment">-- 12312</span></span><br><span class="line">g = <span class="string">&#x27;123&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(g) <span class="comment">-- 123</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong><font size="4">boolean布尔型变量</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">h = <span class="literal">true</span></span><br><span class="line"><span class="built_in">print</span>(h) <span class="comment">-- true</span></span><br><span class="line">i = <span class="literal">false</span></span><br><span class="line"><span class="built_in">print</span>(i) <span class="comment">-- false</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">type函数得到变量的类型</font></strong></p>
<ul>
<li>在type函数中传入变量可以得到变量的类型，type函数的返回值是string。</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(c)) <span class="comment">-- nil</span></span><br><span class="line"><span class="comment">--type函数的返回值是string</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="built_in">type</span>(c))) <span class="comment">-- string</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(d)) <span class="comment">-- number</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(e)) <span class="comment">-- number</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(f)) <span class="comment">-- string</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(g)) <span class="comment">-- string</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(h)) <span class="comment">-- boolean</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(i)) <span class="comment">-- boolean</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="字符串操作"><a href="#字符串操作" class="headerlink" title="字符串操作"></a>字符串操作</h2><p><strong><font size="4">知识回顾</font></strong></p>
<ul>
<li>声明字符串</li>
</ul>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">str1 = <span class="string">&quot;双引号字符串&quot;</span></span><br><span class="line">str2 = <span class="string">&#x27;单引号字符串&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">获取字符串长度</font></strong></p>
<ul>
<li>一个汉字占3个长度</li>
<li>英文字符 占1个长度</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">str1 = <span class="string">&quot;aBcdEfG字符串&quot;</span></span><br><span class="line"><span class="comment">--一个汉字占3个长度</span></span><br><span class="line"><span class="comment">--英文字符 占1个长度</span></span><br><span class="line"><span class="built_in">print</span>(#str1)<span class="comment">--16</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">字符串多行打印</font></strong></p>
<ul>
<li>lua支持转义字符换行来多行打印</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;123\n123&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>输出</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">123</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<ul>
<li>也可以使用[[]]包裹字符串多行打印</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">str1 = <span class="string">[[</span></span><br><span class="line"><span class="string">  我是</span></span><br><span class="line"><span class="string">L</span></span><br><span class="line"><span class="string">]]</span></span><br><span class="line"><span class="built_in">print</span>(str1)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>输出</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  我是</span><br><span class="line">L</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">..和string.format方法进行字符串拼接</font></strong></p>
<p><strong><font size="3">..字符串拼接</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;123&quot;</span> .. <span class="string">&quot;456&quot;</span> ) <span class="comment">-- 123456</span></span><br><span class="line">str1 = <span class="number">111</span></span><br><span class="line">str2 = <span class="number">222</span></span><br><span class="line"><span class="built_in">print</span>(str1 .. str2) <span class="comment">-- 111222</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">字符串拼接方法string.format </font></strong></p>
<ul>
<li>传入字符串和占位符字符串拼接</li>
<li>%d :与数字拼接</li>
<li>%a：与任何字符拼接</li>
<li>%s：与字符配对</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;我是ATM，我今年%d岁了&quot;</span>, <span class="number">18</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">tostring方法让别的类型转字符串</font></strong></p>
<ul>
<li>tostring方法 传入其他类型的变量</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a = <span class="literal">true</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">tostring</span>(a)) <span class="comment">-- true</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">字符串的公共方法</font></strong></p>
<ul>
<li>创建一个String变量作为例子</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">str1 = <span class="string">&quot;abCdefgCd&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：<br>字符串的公共方法一般不会改变原字符串<br>lua的索引是从1开始的</p>
</blockquote>
<p><strong><font size="3">小写转大写方法string.upper 传入字符串</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--str1 = &quot;abCdefgCd&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">upper</span>(str1)) <span class="comment">-- ABCDEFGCD</span></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">大写转小写方法string.upper 传入字符串</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--str1=&quot;ABCDEFGCD&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">lower</span>(str1)) <span class="comment">-- abcdefgcd</span></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">翻转字符串方法string.reverse 传入字符串</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--str1 = &quot;abCdefgCd&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">reverse</span>(str1)) <span class="comment">-- dCgfedCba</span></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">字符串索引查找方法string.find 传入字符串和要查找的字符串 会返回起始和结束索引</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--str1 = &quot;abCdefgCd&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">find</span>(str1, <span class="string">&quot;Cde&quot;</span>)) <span class="comment">-- 3 5</span></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">截取字符串方法string.sub 传入字符串和起始结束索引 不传结束索引默认到传入的字符串尾</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--str1 = &quot;abCdefgCd&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">sub</span>(str1, <span class="number">3</span>)) <span class="comment">-- CdefgCd</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">sub</span>(str1, <span class="number">3</span>, <span class="number">4</span>)) <span class="comment">-- Cd</span></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">字符串重复方法string.rep 传入字符串和重复次数</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--str1 = &quot;abCdefgCd&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">rep</span>(str1, <span class="number">2</span>)) <span class="comment">-- abCdefgCdabCdefgCd</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">字符串修改方法string.gsub 传入要修改的字符和替换后的字符 返回修改后的字符串和修改了几处</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--str1 = &quot;abCdefgCd&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">gsub</span>(str1, <span class="string">&quot;Cd&quot;</span>, <span class="string">&quot;**&quot;</span>)) <span class="comment">-- ab**efg**   2</span></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">字符转ASCII码方法string.byte 传入字符串和要转ASCII码的字符索引</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">str1 = <span class="built_in">string</span>.<span class="built_in">byte</span>(<span class="string">&quot;Lua&quot;</span>, <span class="number">1</span>) <span class="comment">-- 转换L为ASCII码</span></span><br><span class="line"><span class="built_in">print</span>(str1) <span class="comment">-- 76</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">ASCII码转字符方法string.char 传入字符串</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--str1 = 76</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">char</span>(str1)) <span class="comment">-- L</span></span><br></pre></td></tr></table></figure>


<h2 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h2><p><strong><font size="4">算数运算符</font></strong></p>
<ul>
<li>lua的算数运算符主要有 + 加, - 减, * 乘, &#x2F; 除, % 取余, ^ 幂。</li>
<li>lua没有自增自减 ++ –。</li>
<li>lua没有复合运算符 +&#x3D; -&#x3D; &#x2F;&#x3D; *&#x3D; %&#x3D;。</li>
<li>注意：lua字符串可以进行算数运算符操作，进行运算时字符串会自动转成number。</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;加法运算&quot;</span> .. <span class="number">1</span> + <span class="number">2</span>) <span class="comment">-- 3</span></span><br><span class="line">a = <span class="number">1</span></span><br><span class="line">b = <span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;加法运算&quot;</span> .. a + b) <span class="comment">-- 3</span></span><br><span class="line">a = a + b <span class="comment">--3</span></span><br><span class="line"><span class="comment">-- lua没有自增自减a++ 一定要手动a = a + 1</span></span><br><span class="line">a = a + <span class="number">1</span> <span class="comment">-- 4</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;加法运算&quot;</span> .. a + b) <span class="comment">-- 6</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;加法运算&quot;</span> .. <span class="string">&quot;123.4&quot;</span> + <span class="number">1</span>) <span class="comment">-- 124.4</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;减法运算&quot;</span> .. <span class="number">1</span> - <span class="number">2</span>) <span class="comment">-- -1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;减法运算&quot;</span> .. <span class="string">&quot;123.4&quot;</span> - <span class="number">1</span>) <span class="comment">-- 122.4</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;乘法运算&quot;</span> .. <span class="number">1</span> * <span class="number">2</span>) <span class="comment">-- 2</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;乘法运算&quot;</span> .. <span class="string">&quot;123.4&quot;</span> * <span class="number">2</span>) <span class="comment">-- 246.8</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;除法运算&quot;</span> .. <span class="number">1</span> / <span class="number">2</span>) <span class="comment">-- 0.5</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;除法运算&quot;</span> .. <span class="string">&quot;123.4&quot;</span> / <span class="number">2</span>) <span class="comment">-- 61.7</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;取余运算&quot;</span> .. <span class="number">1</span> % <span class="number">2</span>) <span class="comment">-- 1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;取余运算&quot;</span> .. <span class="string">&quot;123.4&quot;</span> % <span class="number">2</span>) <span class="comment">-- 1.4</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;幂运算&quot;</span> .. <span class="number">2</span> ^ <span class="number">5</span>) <span class="comment">-- 32</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;幂运算&quot;</span> .. <span class="string">&quot;123.4&quot;</span> ^ <span class="number">2</span>) <span class="comment">-- 15227.56</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">条件运算符</font></strong></p>
<ul>
<li>lua的条件运算符主要有 &gt; 大于, &lt; 小于, &gt;&#x3D; 大于等于, &lt;&#x3D; 小于等于, &#x3D;&#x3D; 是否等于, ~&#x3D; 是否不等于。</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="number">3</span> &gt; <span class="number">1</span>) <span class="comment">-- true</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">3</span> &lt; <span class="number">1</span>) <span class="comment">-- false</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">3</span> &gt;= <span class="number">1</span>) <span class="comment">-- true</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">3</span> &lt;= <span class="number">1</span>) <span class="comment">-- false</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">3</span> == <span class="number">1</span>) <span class="comment">-- false</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">3</span> ~= <span class="number">1</span>) <span class="comment">-- true</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">逻辑运算符</font></strong></p>
<ul>
<li>lua的逻辑运算符主要有 and 与, or 或, not 非。</li>
<li>注意：lua的逻辑运算遵循逻辑运算的 “短路” 规则，短路就是前面的条件已经符合了就不会再进行运算了。</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">true</span> <span class="keyword">and</span> <span class="literal">false</span>) <span class="comment">-- false</span></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">true</span> <span class="keyword">and</span> <span class="literal">true</span>) <span class="comment">-- true</span></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">false</span> <span class="keyword">and</span> <span class="literal">true</span>) <span class="comment">-- false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">true</span> <span class="keyword">or</span> <span class="literal">false</span>) <span class="comment">-- true</span></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">false</span> <span class="keyword">or</span> <span class="literal">false</span>) <span class="comment">-- false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="keyword">not</span> <span class="literal">true</span>) <span class="comment">-- false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 注意：lua可以和nil进行逻辑运算 之后讲解</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">位运算符</font></strong></p>
<ul>
<li>lua不支持位运算符，需要我们自己实现。</li>
</ul>
<p><strong><font size="4">三目运算符</font></strong></p>
<ul>
<li>lua不支持三目运算符，需要我们自己实现。</li>
</ul>
<h2 id="条件分支语句"><a href="#条件分支语句" class="headerlink" title="条件分支语句"></a>条件分支语句</h2><p><strong><font size="4">单分支if</font></strong></p>
<ul>
<li>单分支if语法：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--if 条件 then</span></span><br><span class="line"><span class="comment">--.....</span></span><br><span class="line"><span class="comment">--end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>示例：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a = <span class="number">10</span></span><br><span class="line"><span class="keyword">if</span> a &gt; <span class="number">5</span> <span class="keyword">then</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;123&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">if</span> a &gt;= <span class="number">3</span> <span class="keyword">and</span> a &lt;= <span class="number">10</span> <span class="keyword">then</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;3到10之间&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="4">双分支if</font></strong></p>
<ul>
<li>双分支if语法：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- if 条件 then</span></span><br><span class="line"><span class="comment">-- .....</span></span><br><span class="line"><span class="comment">-- else</span></span><br><span class="line"><span class="comment">-- .....</span></span><br><span class="line"><span class="comment">-- end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>示例：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> a &lt; <span class="number">5</span> <span class="keyword">then</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;123&quot;</span>)</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;321&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">多分支if</font></strong></p>
<ul>
<li>多分支if语法：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- if 条件 then</span></span><br><span class="line"><span class="comment">-- .....</span></span><br><span class="line"><span class="comment">-- elseif 条件 then</span></span><br><span class="line"><span class="comment">-- ....</span></span><br><span class="line"><span class="comment">-- elseif 条件 then</span></span><br><span class="line"><span class="comment">-- ....</span></span><br><span class="line"><span class="comment">-- else</span></span><br><span class="line"><span class="comment">-- .....</span></span><br><span class="line"><span class="comment">-- end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>注意：多分支if语法中的elseif一定要连着写，否则报错。</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> a &lt; <span class="number">5</span> <span class="keyword">then</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;123&quot;</span>)</span><br><span class="line"><span class="keyword">elseif</span> a == <span class="number">6</span> <span class="keyword">then</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;6&quot;</span>)</span><br><span class="line"><span class="keyword">elseif</span> a == <span class="number">7</span> <span class="keyword">then</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;7&quot;</span>)</span><br><span class="line"><span class="keyword">elseif</span> a == <span class="number">8</span> <span class="keyword">then</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;8&quot;</span>)</span><br><span class="line"><span class="keyword">elseif</span> a == <span class="number">9</span> <span class="keyword">then</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;9&quot;</span>)</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;other&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">多分支switch</font></strong></p>
<ul>
<li>lua不支持switch语法，需要自己实现。</li>
</ul>
<h2 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h2><p><strong><font size="4">while语句</font></strong></p>
<ul>
<li>while语句语法：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">while</span> 进入循环的条件 <span class="keyword">do</span></span><br><span class="line">    <span class="comment">-- 循环体</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>示例：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">num = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> num &lt; <span class="number">5</span> <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(num) <span class="comment">--1 2 3 4 5</span></span><br><span class="line">    num = num + <span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong><font size="4">repeat语句</font></strong></p>
<ul>
<li>repeat语句语法：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">repeat</span></span><br><span class="line">    <span class="comment">-- 循环体</span></span><br><span class="line"><span class="keyword">until</span> 退出循环的条件</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>示例：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">num = <span class="number">0</span></span><br><span class="line"><span class="keyword">repeat</span></span><br><span class="line">    <span class="built_in">print</span>(num) <span class="comment">--1 2 3 4 5</span></span><br><span class="line">    num = num + <span class="number">1</span></span><br><span class="line"><span class="keyword">until</span> num &gt; <span class="number">5</span> <span class="comment">--大于5之后就不进入循环了 和C#的do...while语句的退出循环的条件相反</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="4">for语句</font></strong></p>
<ul>
<li>for语句语法：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">for</span> 变量 = 初始值, 终止条件，步长（可选，不写默认步长是<span class="number">1</span>） <span class="keyword">do</span></span><br><span class="line">    <span class="comment">-- 循环体</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>注意：</p>
<ul>
<li>如果初始值小于等于终止条件，并且步长为正数（默认为1），则循环会从初始值递增，直到循环变量大于等于终止条件，然后退出循环。</li>
<li>如果初始值大于等于终止条件，并且步长为负数，循环会从初始值递减，直到循环变量小于等于终止条件，然后退出循环。</li>
<li>如果初始值和终止条件之间的关系不满足上述两种情况，循环将不执行，即循环体内的代码不会被执行。</li>
<li>步长可以是任何整数值，控制每次迭代中循环变量的增加或减少量。如果不指定步长，默认为1。</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">2</span>, <span class="number">5</span> <span class="keyword">do</span>     <span class="comment">--默认递增 i每次循环会默认+1 i大于5结束循环</span></span><br><span class="line">    <span class="built_in">print</span>(i)        <span class="comment">--2 3 4 5</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span> <span class="keyword">do</span>  <span class="comment">--i每次循环会+2 i大于5结束循环</span></span><br><span class="line">    <span class="built_in">print</span>(i)        <span class="comment">--1 3 5</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">5</span>, <span class="number">1</span>, <span class="number">-1</span> <span class="keyword">do</span> <span class="comment">--i每次循环会-1 i小于1结束循环</span></span><br><span class="line">    <span class="built_in">print</span>(i)        <span class="comment">--5 4 3 2 1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><p><strong><font size="4">函数的基本语法</font></strong></p>
<p><strong><font size="3">命名函数语法</font></strong></p>
<ul>
<li>声明</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> 函数名<span class="params">()</span></span></span><br><span class="line">  <span class="comment">-- 函数体</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<ul>
<li>调用</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">函数名()</span><br></pre></td></tr></table></figure>

<p><strong><font size="3">匿名函数语法</font></strong></p>
<ul>
<li>声明</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">装载函数的变量 = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">  <span class="comment">-- 函数体</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<ul>
<li>调用</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">装载函数的变量()</span><br></pre></td></tr></table></figure>

<p><strong><font size="3">无参数无返回值的函数</font></strong></p>
<ul>
<li>命名的无参数无返回值的函数</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 命名的无参数无返回值的函数</span></span><br><span class="line"><span class="comment">-- F1()--不能再未声明函数前调用函数 否则报错</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F1</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是命名的无参数无返回值的函数F1&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">F1() <span class="comment">--我是命名的无参数无返回值的函数F1</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>匿名的无参数无返回值的函数</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 匿名的无参数无返回值的函数</span></span><br><span class="line">F2 = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是匿名的无参数无返回值的函数F2&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--用F2装载了函数 有点类似C#中的委托和事件</span></span><br><span class="line">F2() <span class="comment">--我是匿名的无参数无返回值的函数F2</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="3">有参数的函数</font></strong></p>
<ul>
<li>有参数的函数在函数的括号中写入参数，不需要声明类型</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F3</span><span class="params">(a)</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是有参数的函数F3&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line">    <span class="comment">-- print(string.format(&quot;参数是%s&quot;, a)) -- 注意占位符 %s 的位置 假如传进来的参数是true或者nil进行字符串拼接会报错</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--有参数的函数在函数的括号中传入参数进行调用</span></span><br><span class="line">F3(<span class="number">1</span>)     <span class="comment">--1</span></span><br><span class="line">F3(<span class="string">&quot;123&quot;</span>) <span class="comment">--123</span></span><br><span class="line">F3(<span class="literal">true</span>)  <span class="comment">--true 假如函数中有字符串拼接的逻辑会报错</span></span><br><span class="line"><span class="comment">--如果传入的参数和函数参数个数不匹配</span></span><br><span class="line"><span class="comment">--不会报错 只会补空nil 或者 丢弃</span></span><br><span class="line">F3()        <span class="comment">--nil 假如函数中有字符串拼接的逻辑会报错</span></span><br><span class="line">F3(<span class="literal">nil</span>)     <span class="comment">--nil 假如函数中有字符串拼接的逻辑会报错</span></span><br><span class="line">F3(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>) <span class="comment">--1 丢弃了后面两个参数</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">有返回值的函数</font></strong></p>
<ul>
<li>单返回值的函数</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--单返回值的函数</span></span><br><span class="line"><span class="comment">--在函数体使用return返回变量</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F4</span><span class="params">(a)</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是单返回值的函数F4&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--用一个变量接返回值</span></span><br><span class="line">temp = F4(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(temp) <span class="comment">--1</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>多返回值的函数</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--多返回值的函数</span></span><br><span class="line"><span class="comment">--在函数体使用return返回多个变量，变量间用逗号隔开</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F5</span><span class="params">(a)</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是多返回值的函数F5&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> a, <span class="string">&quot;123&quot;</span>, <span class="literal">true</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--用多个变量来接多个返回值 值接对应位置的返回值</span></span><br><span class="line"><span class="comment">--如果变量不够不会报错 变量仍然接对应位置的返回值</span></span><br><span class="line"><span class="comment">--如果变量多了不会报错 多出来的变量会被赋值nil</span></span><br><span class="line">temp1, temp2, temp3, temp4 = F5(<span class="string">&quot;1&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(temp1) <span class="comment">--1</span></span><br><span class="line"><span class="built_in">print</span>(temp2) <span class="comment">--123</span></span><br><span class="line"><span class="built_in">print</span>(temp3) <span class="comment">--true</span></span><br><span class="line"><span class="built_in">print</span>(temp4) <span class="comment">--nil</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">函数的类型</font></strong></p>
<ul>
<li>装载函数的变量的变量类型是function</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">F6 = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是被查看函数类型的函数F6&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--使用type方法查看装载函数的变量的变量类型</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(F6)) <span class="comment">--function</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">函数的重载</font></strong></p>
<ul>
<li>lua中的函数不支持重载</li>
<li>同名函数会被最后一个声明的同名函数顶掉，调用时默认调用最后一个声明的同名函数</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--无参函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F7</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是无参函数F7&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--有参函数 已经把无参函数顶掉了</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F7</span><span class="params">(str)</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是有参函数F7&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(str)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--尝试不传参数调用无参函数 但是无参函数被有参函数顶掉 调用的是有参函数</span></span><br><span class="line">F7() <span class="comment">--我是有参函数F7 nil</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="3">变长参数</font></strong></p>
<ul>
<li>在函数的括号中写入…</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F8</span><span class="params">(...)</span></span></span><br><span class="line">  <span class="comment">-- 变长参数使用用一个表存起来</span></span><br><span class="line">  <span class="built_in">arg</span> = &#123; ... &#125;</span><br><span class="line">  <span class="comment">-- #arg可以得到变长参数表的长度</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;我是变成参数F8，参数的长度是&quot;</span> .. #<span class="built_in">arg</span> .. <span class="string">&quot; 传进来的参数如下&quot;</span>)</span><br><span class="line">  <span class="comment">-- 再对表进行遍历输出</span></span><br><span class="line">  <span class="keyword">for</span> i = <span class="number">1</span>, #<span class="built_in">arg</span> <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">arg</span>[i])</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">F8(<span class="number">1</span>, <span class="string">&quot;123&quot;</span>, <span class="literal">true</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>) <span class="comment">-- 1 &quot;123&quot; true 4 5 6</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">函数嵌套</font></strong></p>
<blockquote>
<p>函数的返回值是函数类型的变量</p>
</blockquote>
<ul>
<li>函数返回命名函数</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--函数返回命名函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F9</span><span class="params">()</span></span></span><br><span class="line">    F99 = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;我是F9函数内嵌套并返回出去的函数F99&quot;</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">return</span> F99</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">f9 = F9() <span class="comment">--F9()调用后会返回一个函数 用f9作为装载函数的变量去接</span></span><br><span class="line">f9()      <span class="comment">--我是F9函数内嵌套并返回出去的函数F99</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>函数返回匿名函数</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--函数返回匿名函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F10</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;我是F10函数内嵌套并返回出去的匿名函数&quot;</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">f10 = F10() <span class="comment">--F10()调用后会返回一个函数 用f10作为装载函数的变量去接</span></span><br><span class="line">f10()       <span class="comment">--我是F10函数内嵌套并返回出去的匿名函数</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>闭包</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--闭包</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F11</span><span class="params">(x)</span></span></span><br><span class="line">    <span class="comment">--内部函数捕获外部函数的局部变量x，并可以在外部函数结束后继续使用它</span></span><br><span class="line">    <span class="comment">--改变了传入参数x的生命周期</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">(y)</span></span></span><br><span class="line">        <span class="keyword">return</span> x + y</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">f11 = F11(<span class="number">10</span>)</span><br><span class="line"><span class="comment">--F11(10)会返回一个函数给f11装载</span></span><br><span class="line"><span class="comment">--f11装载的其实是如下这个函数</span></span><br><span class="line"><span class="comment">-- function f11(y)</span></span><br><span class="line"><span class="comment">-- 	return 10 + y</span></span><br><span class="line"><span class="comment">-- end</span></span><br><span class="line"><span class="built_in">print</span>(f11(<span class="number">5</span>)) <span class="comment">--15 因为10+5</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="表"><a href="#表" class="headerlink" title="表"></a>表</h2><p><strong><font size="4">基本概念</font></strong></p>
<ul>
<li>表是一切复杂数据的基础，包括数组、二维数组、字典、类和结构体等等。</li>
<li>所有的复杂类型都是表。</li>
<li>表还提供了一些公共方法给我们使用</li>
</ul>
<p><strong><font size="4">一维数组</font></strong></p>
<p><strong><font size="3">一维数组声明</font></strong></p>
<ul>
<li>一维数组声明语法：表变量 &#x3D; { 元素1, 元素2, …, 元素n }</li>
<li>表的元素可以是任意类型</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">&quot;4&quot;</span>, <span class="literal">nil</span>, <span class="string">&quot;6&quot;</span>, <span class="literal">true</span>, <span class="literal">nil</span> &#125;</span><br></pre></td></tr></table></figure>

<p><strong><font size="3">获得一维数组中的元素</font></strong></p>
<ul>
<li>获得一维数组中的元素语法：表变量[索引]</li>
<li>Lua中的表的索引默认从1开始</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">0</span>]) <span class="comment">-- nil</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">1</span>]) <span class="comment">-- 1</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">2</span>]) <span class="comment">-- 2</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">3</span>]) <span class="comment">-- 3</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">4</span>]) <span class="comment">-- 4</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">5</span>]) <span class="comment">-- nil</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">6</span>]) <span class="comment">-- &quot;6&quot;</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">7</span>]) <span class="comment">-- true</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">8</span>]) <span class="comment">-- nil</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong><font size="3">获取一维数组的长度</font></strong></p>
<ul>
<li>获取一维数组的长度语法：#表变量</li>
<li>‘#’ 是通用的获取数组长度的关键字</li>
<li>如果数组中的某个元素为 nil，它会影响 ‘#’ 操作符返回的数组长度</li>
<li>在计算长度时，nil 元素会被忽略</li>
<li>获取一维数组的长度时，只要遍历到数组元素是 nil，就会认为遍历结束并返回长度</li>
<li>但是由于 Lua 的底层实现和版本差异，有时可能需要遇到第二个 nil 元素才会认为遍历结束并返回长度</li>
<li>因此，不必过于依赖 ‘#’ 操作符返回的值，只需要注意当数组元素存在不确定性时，’#’ 操作符获取的一维数组长度可能不准确</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">&quot;4&quot;</span>, <span class="literal">nil</span>, <span class="string">&quot;6&quot;</span>, <span class="literal">true</span>, <span class="literal">nil</span> &#125;</span><br><span class="line"><span class="built_in">print</span>(#a) <span class="comment">-- 7（Lua 底层实现可能导致遇到第二个 nil 才返回一维数组长度）</span></span><br><span class="line">a = &#123; <span class="number">1</span>, <span class="literal">nil</span>, <span class="number">3</span>, <span class="string">&quot;4&quot;</span>, <span class="literal">nil</span> &#125;</span><br><span class="line"><span class="built_in">print</span>(#a) <span class="comment">-- 1（遇到第一个 nil 就返回）</span></span><br><span class="line">a = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="literal">nil</span>, <span class="number">4</span>, <span class="string">&quot;5&quot;</span>, <span class="literal">true</span>, <span class="literal">nil</span> &#125;</span><br><span class="line"><span class="built_in">print</span>(#a) <span class="comment">-- 2（遇到第一个 nil 就返回）</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">遍历一维数组</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 使用for循环遍历 #表变量获得表长的问题会存在 不赘述</span></span><br><span class="line">a = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">&quot;4&quot;</span>, <span class="literal">nil</span>, <span class="string">&quot;6&quot;</span>, <span class="literal">true</span>, <span class="literal">nil</span> &#125;</span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, #a <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(a[i])</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>


<p><strong><font size="4">二维数组</font></strong></p>
<p><strong><font size="3">二维数组声明</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 二维数组声明语法：</span></span><br><span class="line"><span class="comment">-- 表变量 = </span></span><br><span class="line"><span class="comment">-- &#123;</span></span><br><span class="line"><span class="comment">--  &#123; 表1元素1,表1元素2, 表1元素1 &#125;, </span></span><br><span class="line"><span class="comment">--  &#123; 表2元素1,表2元素2, 表2元素1 &#125; ,</span></span><br><span class="line"><span class="comment">--   ..., </span></span><br><span class="line"><span class="comment">--  &#123; 表n元素1,表n元素2, 表n元素1 &#125;  </span></span><br><span class="line"><span class="comment">-- &#125;</span></span><br><span class="line">a = &#123; &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> &#125;,</span><br><span class="line">    &#123; <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span> &#125; &#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">获得二维数组中的元素</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 获得二维数组中的元素语法：表变量[索引1][索引2]</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">1</span>][<span class="number">1</span>]) <span class="comment">-- 1</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">1</span>][<span class="number">2</span>]) <span class="comment">-- 2</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">1</span>][<span class="number">3</span>]) <span class="comment">-- 3</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">2</span>][<span class="number">1</span>]) <span class="comment">-- 4</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">2</span>][<span class="number">2</span>]) <span class="comment">-- 5</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">2</span>][<span class="number">3</span>]) <span class="comment">-- 6</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">遍历二维数组</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 使用两次for循环遍历 #表变量获得表长的问题会存在 不赘述</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, #a <span class="keyword">do</span></span><br><span class="line">    b = a[i]</span><br><span class="line">    <span class="keyword">for</span> j = <span class="number">1</span>, #b <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">print</span>(b[j])</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">自定义索引</font></strong></p>
<ul>
<li>表自定义索引声明语法:表变量 &#x3D; { [索引1] &#x3D; 元素1, [索引2] &#x3D; 元素2, …, [索引n] &#x3D;元素n }</li>
<li>表自定义索引规则：指定索引的元素关联指定索引，未指定索引的元素的索引从1按顺序增加</li>
<li>注意：</li>
<li>重复索引会报错 比如按顺序增加已经存在了索引2 在指定索引[2] &#x3D; 某元素会报错</li>
<li>同时#表变量返回表长也可能不准确 不要相信#表变量得到的表长</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a = &#123; [<span class="number">0</span>] = <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, [<span class="number">-1</span>] = <span class="number">4</span>, <span class="number">5</span> &#125;</span><br><span class="line"><span class="built_in">print</span>(#a)    <span class="comment">-- 3 只把2,3,5元素算入表长</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">0</span>])  <span class="comment">-- 1</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">1</span>])  <span class="comment">-- 2</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">2</span>])  <span class="comment">-- 3</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">-1</span>]) <span class="comment">-- 4</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">3</span>])  <span class="comment">-- 5</span></span><br><span class="line"><span class="comment">-- 虽然5和3中间夹了个-1索引 但是还是被当做上一个没有被自定义索引按顺序的下一个索引</span></span><br><span class="line"><span class="comment">-- 比如上一个没有自定义索引的元素3是索引2 所以5是索引3</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="number">4</span>]) <span class="comment">-- nil 没有索引4的元素</span></span><br><span class="line"></span><br><span class="line">a = &#123; [<span class="number">1</span>] = <span class="number">1</span>, [<span class="number">2</span>] = <span class="number">2</span>, [<span class="number">4</span>] = <span class="number">4</span>, [<span class="number">5</span>] = <span class="number">5</span>, &#125;</span><br><span class="line"><span class="built_in">print</span>(#a)       <span class="comment">-- 5 2和4中间只隔了一个nil 导致5个元素都能被算入表长</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, #a <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(a[i]) <span class="comment">-- 1 2 nil 4 5</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">a = &#123; [<span class="number">1</span>] = <span class="number">1</span>, [<span class="number">2</span>] = <span class="number">2</span>, [<span class="number">5</span>] = <span class="number">4</span>, [<span class="number">6</span>] = <span class="number">6</span>, &#125;</span><br><span class="line"><span class="built_in">print</span>(#a)       <span class="comment">-- 2 2和5中间只隔了两个nil 只有1,2被算入表长</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, #a <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(a[i]) <span class="comment">-- 1 2</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">迭代器遍历</font></strong></p>
<ul>
<li>#表变量得到表长并不准确</li>
<li>所以一般不要用#来遍历表</li>
<li>建议遍历表时使用迭代器遍历</li>
</ul>
<p><strong><font size="3">ipairs遍历</font></strong></p>
<ul>
<li>ipairs遍历可以遍历键值对，也可以只遍历键不遍历值</li>
<li>ipairs遍历还是从索引1开始往后遍历的 小于等于索引0的元素是得不到的</li>
<li>ipairs遍历只能找到连续索引的 索引如果中间断序了，也无法遍历出后面的内容</li>
<li>比如如下遍历找不到5索引所在的元素6，因为没有4元素</li>
<li>可以看出仍然没有解决#表变量带来的问题</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">a = &#123; [<span class="number">0</span>] = <span class="number">1</span>, <span class="number">2</span>, [<span class="number">-1</span>] = <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, [<span class="number">5</span>] = <span class="number">6</span> &#125;</span><br><span class="line"><span class="comment">--ipairs迭代器遍历键值对</span></span><br><span class="line"><span class="comment">--ipairs遍历键值对语法:</span></span><br><span class="line"><span class="comment">-- for 键变量,值变量 in ipairs(表变量) do</span></span><br><span class="line"><span class="comment">-- 循环体</span></span><br><span class="line"><span class="comment">-- end</span></span><br><span class="line"><span class="keyword">for</span> i, k <span class="keyword">in</span> <span class="built_in">ipairs</span>(a) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ipairs遍历键值对&quot;</span> .. i .. <span class="string">&quot;_&quot;</span> .. k)</span><br><span class="line">    <span class="comment">-- ipairs遍历键值对1_2</span></span><br><span class="line">    <span class="comment">-- ipairs遍历键值对2_4</span></span><br><span class="line">    <span class="comment">-- ipairs遍历键值对3_5</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--ipairs迭代器遍历键</span></span><br><span class="line"><span class="comment">--ipairs遍历键值对语法:</span></span><br><span class="line"><span class="comment">-- for 键变量 in ipairs(表变量) do</span></span><br><span class="line"><span class="comment">-- 循环体</span></span><br><span class="line"><span class="comment">-- end</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">ipairs</span>(a) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ipairs遍历键&quot;</span> .. i)</span><br><span class="line">    <span class="comment">-- ipairs遍历键1</span></span><br><span class="line">    <span class="comment">-- ipairs遍历键2</span></span><br><span class="line">    <span class="comment">-- ipairs遍历键3</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">pairs遍历</font></strong></p>
<ul>
<li>pairs遍历可以遍历键值对，也可以只遍历键不遍历值</li>
<li>pairs遍历能够把所有的键都找到 可以得到所有键值对</li>
<li>解决#表变量带来的问题</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a = &#123; [<span class="number">0</span>] = <span class="number">1</span>, <span class="number">2</span>, [<span class="number">-1</span>] = <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, [<span class="number">5</span>] = <span class="number">6</span> &#125;</span><br><span class="line"><span class="comment">--pairs遍历键值对语法:</span></span><br><span class="line"><span class="comment">-- for 键变量,值变量 in pairs(表变量) do</span></span><br><span class="line"><span class="comment">-- 循环体</span></span><br><span class="line"><span class="comment">-- end</span></span><br><span class="line"><span class="comment">--pairs能够把所有的键都找到 这样就可以得到所有键值对</span></span><br><span class="line"><span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">pairs</span>(a) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;pairs遍历键值对&quot;</span> .. i .. <span class="string">&quot;_&quot;</span> .. v)</span><br><span class="line">    <span class="comment">-- pairs遍历键值对1_2</span></span><br><span class="line">    <span class="comment">-- pairs遍历键值对2_4</span></span><br><span class="line">    <span class="comment">-- pairs遍历键值对3_5</span></span><br><span class="line">    <span class="comment">-- pairs遍历键值对0_1</span></span><br><span class="line">    <span class="comment">-- pairs遍历键值对-1_3</span></span><br><span class="line">    <span class="comment">-- pairs遍历键值对5_6</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--pairs遍历键值对语法:</span></span><br><span class="line"><span class="comment">-- for 键变量 in ipairs(表变量) do</span></span><br><span class="line"><span class="comment">-- 循环体</span></span><br><span class="line"><span class="comment">-- end</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">pairs</span>(a) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;pairs遍历键&quot;</span> .. i)</span><br><span class="line">    <span class="comment">-- pairs遍历键1</span></span><br><span class="line">    <span class="comment">-- pairs遍历键2</span></span><br><span class="line">    <span class="comment">-- pairs遍历键3</span></span><br><span class="line">    <span class="comment">-- pairs遍历键0</span></span><br><span class="line">    <span class="comment">-- pairs遍历键-1</span></span><br><span class="line">    <span class="comment">-- pairs遍历键5</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">字典</font></strong></p>
<p><strong><font size="3">字典的声明</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--字典的声明语法：表变量 = &#123;[&quot;键1&quot;] = &quot;值1&quot;, [&quot;键2&quot;] = &quot;值2&quot;,...[&quot;键3&quot;] = &quot;值3&quot;]&#125;</span></span><br><span class="line"><span class="comment">--字典是由键值对构成  和自定义索引声明类似 只是键和值多了双引号&quot;&quot;包裹</span></span><br><span class="line">a = &#123; [<span class="string">&quot;name&quot;</span>] = <span class="string">&quot;奥特曼&quot;</span>, [<span class="string">&quot;age&quot;</span>] = <span class="number">22</span>, [<span class="string">&quot;1&quot;</span>] = <span class="number">1</span> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">访问字典值</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--表变量[&quot;键&quot;] 用中括号来访问值 键要带上双引号&quot;&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="string">&quot;name&quot;</span>]) <span class="comment">--奥特曼</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="string">&quot;age&quot;</span>])  <span class="comment">--22</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="string">&quot;1&quot;</span>])    <span class="comment">--1</span></span><br><span class="line"><span class="comment">--表变量.键 用点访问值 类似C#中.成员变量的形式得到值</span></span><br><span class="line"><span class="built_in">print</span>(a.name)    <span class="comment">--奥特曼</span></span><br><span class="line"><span class="built_in">print</span>(a.age)     <span class="comment">--22</span></span><br><span class="line"><span class="comment">--虽然可以通过.成员变量的形式得到值 但是不能是数字</span></span><br><span class="line"><span class="comment">-- print(a.1)--报错</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="string">&quot;1&quot;</span>]) <span class="comment">--1</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">修改字典值</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--表变量[&quot;键&quot;] = &quot;新值&quot;</span></span><br><span class="line">a[<span class="string">&quot;name&quot;</span>] = <span class="string">&quot;奥特曼1&quot;</span>;</span><br><span class="line"><span class="built_in">print</span>(a[<span class="string">&quot;name&quot;</span>]) <span class="comment">--奥特曼1</span></span><br><span class="line"><span class="comment">--表变量.键 = &quot;新值&quot;</span></span><br><span class="line">a.name = <span class="string">&quot;奥特曼帅&quot;</span>;</span><br><span class="line"><span class="built_in">print</span>(a.name) <span class="comment">--奥特曼帅</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong><font size="3">新增字典值</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--表变量[&quot;新键&quot;] = &quot;新值&quot;</span></span><br><span class="line">a[<span class="string">&quot;sex&quot;</span>] = <span class="literal">false</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="string">&quot;sex&quot;</span>]) <span class="comment">--false</span></span><br><span class="line"><span class="comment">--表变量.新键 = &quot;新值&quot;</span></span><br><span class="line">a.handsome = <span class="literal">true</span></span><br><span class="line"><span class="built_in">print</span>(a.handsome) <span class="comment">--true</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">删除字典值</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--表变量[&quot;键&quot;] = nil</span></span><br><span class="line">a[<span class="string">&quot;sex&quot;</span>] = <span class="literal">nil</span></span><br><span class="line"><span class="built_in">print</span>(a[<span class="string">&quot;sex&quot;</span>]) <span class="comment">--nil</span></span><br><span class="line"><span class="comment">--表变量.键 = nil</span></span><br><span class="line">a.handsome = <span class="literal">nil</span></span><br><span class="line"><span class="built_in">print</span>(a.handsome) <span class="comment">--nil</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">字典的遍历</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--遍历一定要用pairs迭代器遍历</span></span><br><span class="line"><span class="comment">--键值对遍历</span></span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(a) <span class="keyword">do</span></span><br><span class="line">    <span class="comment">--可以传多个参数 一样可以打印出来</span></span><br><span class="line">    <span class="built_in">print</span>(k, v)</span><br><span class="line">    <span class="comment">-- 1	1</span></span><br><span class="line">    <span class="comment">-- name	奥特曼帅</span></span><br><span class="line">    <span class="comment">-- age	22</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--遍历键 通过键得到值</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">pairs</span>(a) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(k)</span><br><span class="line">    <span class="built_in">print</span>(a[k])</span><br><span class="line">    <span class="comment">-- 1</span></span><br><span class="line">    <span class="comment">-- 1</span></span><br><span class="line">    <span class="comment">-- name</span></span><br><span class="line">    <span class="comment">-- 奥特曼帅</span></span><br><span class="line">    <span class="comment">-- age</span></span><br><span class="line">    <span class="comment">-- 22</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--遍历值 可以用_省略键</span></span><br><span class="line"><span class="keyword">for</span> _, v <span class="keyword">in</span> <span class="built_in">pairs</span>(a) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(_, v)</span><br><span class="line">    <span class="comment">-- 1	1</span></span><br><span class="line">    <span class="comment">-- name	奥特曼帅</span></span><br><span class="line">    <span class="comment">-- age	22</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="4">类和结构体</font></strong></p>
<ul>
<li>Lua中是默认没有面向对象的 需要我们自己来实现 Lua中实现类和结构体都是类似的</li>
</ul>
<p><strong><font size="3">类声明</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 类声明语法：</span></span><br><span class="line"><span class="comment">-- 类 = &#123;</span></span><br><span class="line"><span class="comment">--成员变量，</span></span><br><span class="line"><span class="comment">--成员函数，</span></span><br><span class="line"><span class="comment">-- ...</span></span><br><span class="line"><span class="comment">-- &#125;</span></span><br><span class="line"></span><br><span class="line">Student = &#123;</span><br><span class="line">    <span class="comment">--年龄</span></span><br><span class="line">    age = <span class="number">1</span>,</span><br><span class="line">    <span class="comment">--性别</span></span><br><span class="line">    sex = <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">--打印函数1</span></span><br><span class="line">    Print1 = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;进入打印函数1&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(age)</span><br><span class="line">        <span class="comment">--这样打印的age和Student类中的age没有任何关系 打印的age是一个全局变量</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">--在表内部函数中 调用类本身的属性或者方法 要指定类</span></span><br><span class="line">        <span class="comment">--类.属性 或 类.方法()</span></span><br><span class="line">        <span class="built_in">print</span>(Student.age)</span><br><span class="line">        <span class="built_in">print</span>(Student.sex)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;退出打印函数1&quot;</span>)</span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line">    <span class="comment">--打印函数2</span></span><br><span class="line">    Print2 = <span class="function"><span class="keyword">function</span><span class="params">(myStudent)</span></span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;进入打印函数2&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">--可以使用有参函数 把当前类作为一个参数传进来函数中来</span></span><br><span class="line">        <span class="comment">--在函数内部调用类本身的属性或者方法 在内部访问</span></span><br><span class="line">        <span class="built_in">print</span>(Student.age)</span><br><span class="line">        <span class="built_in">print</span>(myStudent.sex)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;退出打印函数2&quot;</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">实例化类对象</font></strong></p>
<ul>
<li>C#是使用类实例化new出对象 静态成员.出成员</li>
<li>Lua中是没有实例化new的概念的 类的表现更像是一个类中有很多静态成员</li>
<li>要自己实现面向对象</li>
</ul>
<p><strong><font size="3">得到类的成员变量</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--直接 类.变量 得到变量</span></span><br><span class="line"><span class="built_in">print</span>(Student.age) <span class="comment">--1</span></span><br><span class="line"><span class="built_in">print</span>(Student.sex) <span class="comment">--true</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">在类外添加的成员变量</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--声明类过后 可以直接在类外 类.变量 = 值 添加成员变量</span></span><br><span class="line">Student.name = <span class="string">&quot;奥特曼&quot;</span></span><br><span class="line"><span class="built_in">print</span>(Student.name) <span class="comment">--奥特曼</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="3">使用.调用类的成员方法</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Student.Print1()</span><br><span class="line"><span class="comment">-- 进入打印函数1</span></span><br><span class="line"><span class="comment">-- nil</span></span><br><span class="line"><span class="comment">-- 1</span></span><br><span class="line"><span class="comment">-- true</span></span><br><span class="line"><span class="comment">-- 退出打印函数1</span></span><br><span class="line">Student.Print2(Student) <span class="comment">--传入当前类作为参数</span></span><br><span class="line"><span class="comment">-- 进入打印函数2</span></span><br><span class="line"><span class="comment">-- 1</span></span><br><span class="line"><span class="comment">-- true</span></span><br><span class="line"><span class="comment">-- 退出打印函数2</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="3">使用.在类外添加的成员方法</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--声明类过后 可以直接在类外</span></span><br><span class="line"><span class="comment">-- 类.方法 = function()</span></span><br><span class="line"><span class="comment">--     函数体</span></span><br><span class="line"><span class="comment">-- end</span></span><br><span class="line"><span class="comment">-- 来添加成员方法</span></span><br><span class="line">Student.Print3 = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;进入打印函数3&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(Student.age)</span><br><span class="line">    <span class="built_in">print</span>(Student.sex)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;退出打印函数3&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">Student.Print3()</span><br><span class="line"><span class="comment">-- 进入打印函数3</span></span><br><span class="line"><span class="comment">-- 1</span></span><br><span class="line"><span class="comment">-- true</span></span><br><span class="line"><span class="comment">-- 退出打印函数3</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong><font size="3">使用:调用类的成员方法</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--冒号调用方法 会默认把调用者 作为调用的方法的第一个参数传入方法中</span></span><br><span class="line">Student:Print2() <span class="comment">--虽然没有显式的传入Student作为参数 但是因为是:调用函数 已经隐式的传入Student作为参数了</span></span><br><span class="line"><span class="comment">-- 进入打印函数2</span></span><br><span class="line"><span class="comment">-- 1</span></span><br><span class="line"><span class="comment">-- true</span></span><br><span class="line"><span class="comment">-- 退出打印函数2</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">使用:在类外添加的成员方法 </font></strong></p>
<ul>
<li>self来表示默认传入的第一个参数</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--声明类过后 可以直接在类外</span></span><br><span class="line"><span class="comment">-- 类:方法 = function()</span></span><br><span class="line"><span class="comment">--     函数体</span></span><br><span class="line"><span class="comment">-- end</span></span><br><span class="line"><span class="comment">-- 来添加成员方法</span></span><br><span class="line"><span class="comment">--使用了:声明方法后 代表方法会有一个默认的参数</span></span><br><span class="line"><span class="comment">--在方法内 通过self来表示默认传入的第一个参数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student:Print4</span><span class="params">()</span></span> <span class="comment">--虽然没有显式的有参数 但是因为是:声明函数 已经隐式的让这个函数有参数了</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;进入打印函数4&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">self</span>.age)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">self</span>.sex)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;退出打印函数4&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">在类外调用使用:在类外添加的成员方法</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- Student.Print4()--报错 Print4因为是:声明函数 需要传入参数</span></span><br><span class="line">Student.Print4(Student) <span class="comment">--传入了Student类自身作为参数 正常调用</span></span><br><span class="line"><span class="comment">-- 进入打印函数4</span></span><br><span class="line"><span class="comment">-- 1</span></span><br><span class="line"><span class="comment">-- true</span></span><br><span class="line"><span class="comment">-- 退出打印函数4</span></span><br><span class="line">Student:Print4() <span class="comment">--冒号调用方法 会把调用者Student作为第一个参数传进去 正常调用</span></span><br><span class="line"><span class="comment">-- 进入打印函数4</span></span><br><span class="line"><span class="comment">-- 1</span></span><br><span class="line"><span class="comment">-- true</span></span><br><span class="line"><span class="comment">-- 退出打印函数4</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">表的公共方法</font></strong></p>
<ul>
<li>插入 table.insert</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">t1 = &#123; &#123; age = <span class="number">1</span>, name = <span class="string">&quot;111&quot;</span> &#125;, &#123; age = <span class="number">2</span>, name = <span class="string">&quot;222&quot;</span> &#125; &#125;</span><br><span class="line">t2 = &#123; name = <span class="string">&quot;奥特曼&quot;</span>, sex = <span class="literal">true</span> &#125;</span><br><span class="line"><span class="comment">-- table.insert(要插入元素的表，插入的表) 会把插入的表的表作为要插入元素的表作为顺序索引的最后一个元素</span></span><br><span class="line"><span class="built_in">print</span>(#t1)        <span class="comment">--2</span></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">insert</span>(t1, t2);</span><br><span class="line"><span class="built_in">print</span>(#t1)        <span class="comment">--3</span></span><br><span class="line"><span class="built_in">print</span>(t1[<span class="number">1</span>].name) <span class="comment">--111</span></span><br><span class="line"><span class="built_in">print</span>(t1[<span class="number">2</span>].name) <span class="comment">--222</span></span><br><span class="line"><span class="built_in">print</span>(t1[<span class="number">3</span>].name) <span class="comment">--奥特曼 代表把t2的的元素插入成功了</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>删除 table.remove</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">t1 = &#123; &#123; age = <span class="number">1</span>, name = <span class="string">&quot;111&quot;</span> &#125;, &#123; age = <span class="number">2</span>, name = <span class="string">&quot;222&quot;</span> &#125;, &#123; name = <span class="string">&quot;奥特曼&quot;</span>, sex = <span class="literal">true</span> &#125; &#125;</span><br><span class="line"><span class="comment">--table.remove(要移除元素的表) 会移除传入的表的最后一个索引的内容</span></span><br><span class="line"><span class="built_in">print</span>(#t1)        <span class="comment">--3</span></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">remove</span>(t1)</span><br><span class="line"><span class="built_in">print</span>(#t1)        <span class="comment">--2</span></span><br><span class="line"><span class="built_in">print</span>(t1[<span class="number">1</span>].name) <span class="comment">--111</span></span><br><span class="line"><span class="built_in">print</span>(t1[<span class="number">2</span>].name) <span class="comment">--222</span></span><br><span class="line"><span class="built_in">print</span>(t1[<span class="number">3</span>])      <span class="comment">--nil 最后一个元素被移除了</span></span><br><span class="line"><span class="comment">--table.remove(要移除元素的表, 移除元素索引)</span></span><br><span class="line"><span class="built_in">print</span>(#t1)        <span class="comment">--2</span></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">remove</span>(t1, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(#t1)        <span class="comment">--1</span></span><br><span class="line"><span class="built_in">print</span>(t1[<span class="number">1</span>].name) <span class="comment">--222 name为111的元素被移除了</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>排序 table.sort</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">t1 = &#123; <span class="number">5</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span> &#125;</span><br><span class="line"><span class="comment">--table.sort(要排序的表) 默认升序排列</span></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">sort</span>(t1)</span><br><span class="line"><span class="keyword">for</span> _, v <span class="keyword">in</span> <span class="built_in">pairs</span>(t1) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(v)</span><br><span class="line">    <span class="comment">-- 1</span></span><br><span class="line">    <span class="comment">-- 2</span></span><br><span class="line">    <span class="comment">-- 3</span></span><br><span class="line">    <span class="comment">-- 4</span></span><br><span class="line">    <span class="comment">-- 5</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--table.sort(要排序的表,排序规则函数)</span></span><br><span class="line"><span class="comment">-- 排序函数接受两个参数，通常命名为 a 和 b，用于表示待比较的两个元素。</span></span><br><span class="line"><span class="comment">-- 排序函数根据 a 和 b 的比较结果返回 true 或 false，以指示元素的相对顺序。</span></span><br><span class="line"><span class="comment">-- 如果排序函数返回 true，则表示 a 应该在 b 前面。</span></span><br><span class="line"><span class="comment">-- 如果排序函数返回 false，则表示 b 应该在 a 前面。</span></span><br><span class="line"><span class="comment">-- 排序函数必须返回布尔值，且只有 true 或 false。</span></span><br><span class="line"><span class="comment">--降序</span></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">sort</span>(t1, <span class="function"><span class="keyword">function</span><span class="params">(a, b)</span></span></span><br><span class="line">    <span class="keyword">return</span> a &gt; b</span><br><span class="line"><span class="keyword">end</span>)</span><br><span class="line"><span class="keyword">for</span> _, v <span class="keyword">in</span> <span class="built_in">pairs</span>(t1) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(v)</span><br><span class="line">    <span class="comment">-- 5</span></span><br><span class="line">    <span class="comment">-- 4</span></span><br><span class="line">    <span class="comment">-- 3</span></span><br><span class="line">    <span class="comment">-- 2</span></span><br><span class="line">    <span class="comment">-- 1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--升序</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AscendingSort</span><span class="params">(a, b)</span></span></span><br><span class="line">    <span class="keyword">return</span> a &lt; b</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">sort</span>(t1, AscendingSort)</span><br><span class="line"><span class="keyword">for</span> _, v <span class="keyword">in</span> <span class="built_in">pairs</span>(t1) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(v)</span><br><span class="line">    <span class="comment">-- 1</span></span><br><span class="line">    <span class="comment">-- 2</span></span><br><span class="line">    <span class="comment">-- 3</span></span><br><span class="line">    <span class="comment">-- 4</span></span><br><span class="line">    <span class="comment">-- 5</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>拼接 table.concat</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">t1 = &#123; <span class="string">&quot;123&quot;</span>, <span class="string">&quot;456&quot;</span>, <span class="string">&quot;789&quot;</span>, <span class="string">&quot;10101&quot;</span> &#125;</span><br><span class="line"><span class="comment">--table.concat(要拼接的表, &quot;元素间的符号&quot;) 返回值是一个拼接好的字符串</span></span><br><span class="line">str = <span class="built_in">table</span>.<span class="built_in">concat</span>(t1, <span class="string">&quot;@@&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(str) <span class="comment">--123@@456@@789@@10101</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="多脚本"><a href="#多脚本" class="headerlink" title="多脚本"></a>多脚本</h2><p><strong><font size="4">全局变量和局部变量</font></strong></p>
<p><strong><font size="3">全局变量</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--直接 变量 = 值 声明的变量都是全局变量</span></span><br><span class="line">a = <span class="number">1</span></span><br><span class="line">b = <span class="string">&quot;123&quot;</span></span><br><span class="line"><span class="comment">-- lua中的循环体内的变量如果也是 变量 = 值 这样赋值的话也是全局变量 循环体外也能使用</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, <span class="number">2</span> <span class="keyword">do</span></span><br><span class="line">    c = <span class="string">&quot;奥特曼&quot;</span> <span class="comment">--循环体内全局变量赋值</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment">--奥特曼 循环体外得到循环体内全局变量赋值</span></span><br><span class="line"><span class="comment">--频繁使用全局变量非常消耗内存</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">局部变量</font></strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">--局部变量的关键字local</span><br><span class="line">--通过 local 变量 = 值 声明局部变量</span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, <span class="number">2</span> <span class="keyword">do</span></span><br><span class="line">    local d = <span class="string">&quot;奥特曼&quot;</span></span><br><span class="line">    print(<span class="string">&quot;循环中的d&quot;</span> .. d) --循环中的d奥特曼 循环体内可以使用局部变量</span><br><span class="line"><span class="function">end</span></span><br><span class="line"><span class="function"><span class="title">print</span>(<span class="params">d</span>) --nil 循环体外不能使用局部变量</span></span><br><span class="line"><span class="function">fun</span> = function()</span><br><span class="line">    local tt = <span class="string">&quot;123123123&quot;</span> --函数中假如不加local的变量也会作为全局变量</span><br><span class="line"><span class="function">end</span></span><br><span class="line"><span class="function"><span class="title">fun</span>()</span></span><br><span class="line"><span class="function"><span class="title">print</span>(<span class="params">tt</span>)  --nil 函数中tt加了local是局部变量了</span></span><br><span class="line"><span class="function">local tt2</span> = <span class="string">&quot;555&quot;</span></span><br><span class="line">print(tt2) -<span class="number">-555</span> 刚声明的局部变量当然可以使用</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">执行多脚本</font></strong></p>
<p><strong><font size="3">声明一个脚本</font></strong></p>
<ul>
<li>新建一个NewLua(LuaMultiScriptTest)脚本</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;我是LuaMultiScriptTest脚本&quot;</span>)</span><br><span class="line">GlobalVariable = <span class="string">&quot;我是全局变量&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;在LuaMultiScriptTest脚本打印的:&quot;</span>..GlobalVariable)</span><br><span class="line"><span class="keyword">local</span> LocalAVariable = <span class="string">&quot;我是局部变量&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;在LuaMultiScriptTest脚本打印的:&quot;</span>..LocalAVariable)</span><br><span class="line"><span class="comment">-- 可以在脚本最后返回一个外部希望获取的内容 比如返回一个局部变量  给外部得到</span></span><br><span class="line"><span class="keyword">return</span> LocalAVariable</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong><font size="3">多脚本执行关键字 require 用于执行并加载指定脚本。</font></strong></p>
<ul>
<li>多脚本执行关键字require 传入脚本名用双引号或单引号包裹 require后会执行并加载传入的脚本</li>
<li>require(“脚本名”) require(‘脚本名’)</li>
<li>注意：脚本名不能是中文 执行的脚本要和当前脚本在同一目录下</li>
<li>在LuaTest脚本调用</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;LuaMultiScriptTest&#x27;</span>) <span class="comment">--执行LuaMultiScriptTest这个测试Lua中多脚本的脚本</span></span><br><span class="line"><span class="comment">-- 我是LuaMultiScriptTest脚本</span></span><br><span class="line"><span class="comment">-- 在LuaMultiScriptTest脚本打印的:我是全局变量</span></span><br><span class="line"><span class="comment">-- 在LuaMultiScriptTest脚本打印的:我是局部变量</span></span><br><span class="line"><span class="built_in">print</span>(GlobalVariable)         <span class="comment">--我是全局变量 LuaMultiScriptTest脚本的全局变量能被当前脚本使用</span></span><br><span class="line"><span class="built_in">print</span>(LocalAVariable)         <span class="comment">--nil LuaMultiScriptTest脚本的局部变量不能被当前脚本使用</span></span><br><span class="line"><span class="comment">--如果是已经被require加载执行的脚本 加载一次过后不会再被执行</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&quot;LuaMultiScriptTest&quot;</span>)</span><br><span class="line"><span class="comment">--require执行一个脚本时 可以在脚本最后返回一个外部希望获取的内容 比如返回一个局部变量 用一个变量来接</span></span><br><span class="line"><span class="comment">--由于加载过一次LuaMultiScriptTest 先卸载LuaMultiScriptTest</span></span><br><span class="line"><span class="built_in">package</span>.<span class="built_in">loaded</span>[<span class="string">&quot;LuaMultiScriptTest&quot;</span>] = <span class="literal">nil</span></span><br><span class="line"><span class="comment">--再重新加载LuaMultiScriptTest</span></span><br><span class="line"><span class="keyword">local</span> testLA = <span class="built_in">require</span>(<span class="string">&quot;LuaMultiScriptTest&quot;</span>)</span><br><span class="line"><span class="comment">-- 我是LuaMultiScriptTest脚本</span></span><br><span class="line"><span class="comment">-- 在LuaMultiScriptTest脚本打印的:我是全局变量</span></span><br><span class="line"><span class="comment">-- 在LuaMultiScriptTest脚本打印的:我是局部变量</span></span><br><span class="line"><span class="built_in">print</span>(testLA) <span class="comment">--我是局部变量</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">卸载多脚本</font></strong></p>
<ul>
<li>package.loaded[“脚本名”] 返回boolean 判断该脚本是否被执行</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">package</span>.<span class="built_in">loaded</span>[<span class="string">&quot;LuaMultiScriptTest&quot;</span>]) <span class="comment">--假如没有在LuaMultiScriptTest脚本最后返回值的话是true 返回了的话是我是局部变量</span></span><br><span class="line"><span class="comment">---package.loaded[&quot;脚本名&quot;] = nil 卸载已经执行过的脚本</span></span><br><span class="line"><span class="built_in">package</span>.<span class="built_in">loaded</span>[<span class="string">&quot;LuaMultiScriptTest&quot;</span>] = <span class="literal">nil</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">package</span>.<span class="built_in">loaded</span>[<span class="string">&quot;LuaMultiScriptTest&quot;</span>]) <span class="comment">--nil</span></span><br><span class="line"><span class="comment">--可以重新加载LuaMultiScriptTest了</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&quot;LuaMultiScriptTest&quot;</span>)</span><br><span class="line"><span class="comment">-- 我是LuaMultiScriptTest脚本</span></span><br><span class="line"><span class="comment">-- 在LuaMultiScriptTest脚本打印的:我是全局变量</span></span><br><span class="line"><span class="comment">-- 在LuaMultiScriptTest脚本打印的:我是局部变量</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">大G表</font></strong></p>
<ul>
<li>_G表是一个总表(table) 他将我们申明的所有全局的变量都存储在其中</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(<span class="built_in">_G</span>) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(k, v)</span><br><span class="line">    <span class="comment">-- a	1</span></span><br><span class="line">    <span class="comment">-- string	table: 00B49FE8</span></span><br><span class="line">    <span class="comment">-- xpcall	function: 00B479D0</span></span><br><span class="line">    <span class="comment">-- b	123</span></span><br><span class="line">    <span class="comment">-- package	table: 00B48050</span></span><br><span class="line">    <span class="comment">-- tostring	function: 00B47950</span></span><br><span class="line">    <span class="comment">-- print	function: 00B47590</span></span><br><span class="line">    <span class="comment">-- os	table: 00B4A038</span></span><br><span class="line">    <span class="comment">-- ...</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--局部变量 加了local的变量时不会存到大_G表中</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="特殊语法"><a href="#特殊语法" class="headerlink" title="特殊语法"></a>特殊语法</h2><p><strong><font size="4">多变量赋值</font></strong></p>
<ul>
<li>多变量赋值语法：变量1，变量2，…变量n &#x3D; 值1，值2，…值n</li>
<li>示例：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a, b, c = <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment">--1</span></span><br><span class="line"><span class="built_in">print</span>(b) <span class="comment">--2</span></span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment">--3</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>如果值不够匹配变量，未匹配到值的变量会是nil</li>
<li>示例：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a, b, c = <span class="number">1</span>, <span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment">--1</span></span><br><span class="line"><span class="built_in">print</span>(b) <span class="comment">--2</span></span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment">--nil</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>如果值比变量多，多出来的值没有被使用</li>
<li>示例：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a, b, c = <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span></span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment">--1</span></span><br><span class="line"><span class="built_in">print</span>(b) <span class="comment">--2</span></span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment">--3</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="4">多返回值</font></strong></p>
<ul>
<li>多返回值语法：return 值1，值2，…值n，一般用于函数中</li>
<li>示例：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Test</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>如果返回的值比用来接的变量多，多出来的值没有被使用</li>
<li>示例：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a, b, c = Test()</span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment">--1</span></span><br><span class="line"><span class="built_in">print</span>(b) <span class="comment">--2</span></span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment">--3</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>如果返回的值不够匹配用来接的变量，未匹配到值的变量会是nil</li>
<li>示例：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a, b, c, d, e = Test()</span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment">--1</span></span><br><span class="line"><span class="built_in">print</span>(b) <span class="comment">--2</span></span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment">--3</span></span><br><span class="line"><span class="built_in">print</span>(d) <span class="comment">--4</span></span><br><span class="line"><span class="built_in">print</span>(e) <span class="comment">--nil</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="4">and和or的特性</font></strong></p>
<ul>
<li>在lua中，逻辑与and和逻辑或or不仅可以连接boolean，任何变量都可以用来连接。只有nil和false才认为是假，其他都认为是真。</li>
<li>逻辑与and运算符在左操作数为真时返回右操作数，否则返回左操作数。口诀：都真则真，有假则假。</li>
<li>逻辑或or运算符在左操作数为真时返回左操作数，否则返回右操作数。口诀：都假则假，有真则真。</li>
<li>这是因为lua的逻辑运算符是短路运算的。</li>
<li>比如and第一个数都是否了，就不用看第二个数脸色了。直接返回第一个数。否则就返回第二个数。</li>
<li>比如or第一个数都是真了，就不用看第二个数脸色了。直接返回第一个数。否则就返回第二个数。</li>
<li>示例：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="number">1</span> <span class="keyword">and</span> <span class="number">2</span>)      <span class="comment">-- 2，都真则真，因为1为真，所以返回2。</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">0</span> <span class="keyword">and</span> <span class="number">1</span>)      <span class="comment">-- 1，都真则真，因为0为真，所以返回1。</span></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">nil</span> <span class="keyword">and</span> <span class="number">1</span>)    <span class="comment">-- nil，有假则假，因为nil为假，所以返回nil。</span></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">false</span> <span class="keyword">and</span> <span class="number">2</span>)  <span class="comment">-- false，有假则假，因为false为假，所以返回false。</span></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">true</span> <span class="keyword">and</span> <span class="number">3</span>)   <span class="comment">-- 3，都真则真，因为true为真，所以返回3。</span></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">true</span> <span class="keyword">or</span> <span class="number">1</span>)    <span class="comment">-- true，有真则真，因为true为真，所以返回true。</span></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">false</span> <span class="keyword">or</span> <span class="number">1</span>)   <span class="comment">-- 1，都假则假，因为false为假，所以返回1。</span></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">nil</span> <span class="keyword">or</span> <span class="number">2</span>)     <span class="comment">-- 2，都假则假，因为nil为假，所以返回2。</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>lua不支持三目运算符，但可以使用and和or模拟三目运算符。</li>
<li>lua中的三元运算模拟：result &#x3D; (条件表达式) and 条件为真时返回值 or 条件为假时返回值。</li>
<li>示例：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">x = <span class="number">3</span></span><br><span class="line">y = <span class="number">2</span></span><br><span class="line"><span class="keyword">local</span> result = (x &gt; y) <span class="keyword">and</span> x <span class="keyword">or</span> y <span class="comment">-- 对应C#的三目运算符 x&gt;y?x:y;</span></span><br><span class="line"><span class="built_in">print</span>(result) <span class="comment">-- 输出：3</span></span><br><span class="line"><span class="comment">-- 如果(x&gt;y)为真，那么 (x&gt;y) and x 会返回x，然后x再和y或一下，因为x一般不是nil或false，所以会返回x</span></span><br><span class="line"><span class="comment">-- (x&gt;y) and x ——&gt; x</span></span><br><span class="line"><span class="comment">-- x or y ——&gt; x</span></span><br><span class="line">x = <span class="number">1</span></span><br><span class="line">y = <span class="number">2</span></span><br><span class="line"><span class="keyword">local</span> result = (x &gt; y) <span class="keyword">and</span> x <span class="keyword">or</span> y <span class="comment">-- 对应C#的三目运算符 x&gt;y?x:y;</span></span><br><span class="line"><span class="built_in">print</span>(result) <span class="comment">-- 输出：2</span></span><br><span class="line"><span class="comment">-- 如果(x&gt;y)为假，那么 (x&gt;y) and x 会返回(x&gt;y)，然后(x&gt;y)再和y或一下，因为(x&gt;y)为假已经是假了，所以肯定会返回y</span></span><br><span class="line"><span class="comment">-- (x&gt;y) and x ——&gt; (x&gt;y)</span></span><br><span class="line"><span class="comment">-- (x&gt;y) or y ——&gt; y</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果(x&gt;y)为真，那么 (x&gt;y) and x 会返回x，然后x再和y或一下，因为x一般不是nil或false，所以会返回x。<br>如果(x&gt;y)为假，那么 (x&gt;y) and x 会返回(x&gt;y)，然后(x&gt;y)再和y或一下，因为(x&gt;y)为假已经是假了，所以肯定会返回y。</p>
</blockquote>
<h2 id="协同程序"><a href="#协同程序" class="headerlink" title="协同程序"></a>协同程序</h2><p><strong><font size="4">协程的创建</font></strong></p>
<ul>
<li>创建协程有两种方法 create 和 wrap 分别创建线程型和函数型的协程变量。</li>
</ul>
<p><strong><font size="3">线程型 coroutine.create(函数变量)</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">myFunction1 = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是myFunction1&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--coroutine.create(函数变量) 会返回线程thread类型的变量 较常用</span></span><br><span class="line">myCoroutine1 = <span class="built_in">coroutine</span>.<span class="built_in">create</span>(myFunction1)</span><br><span class="line"><span class="built_in">print</span>(myCoroutine1)       <span class="comment">--thread: 00B5EA90</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(myCoroutine1)) <span class="comment">--thread</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">函数型 coroutine.wrap(函数变量)</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--coroutine.wrap(函数变量) 会返回函数function类型的变量 不太常用</span></span><br><span class="line">myCoroutine2 = <span class="built_in">coroutine</span>.<span class="built_in">wrap</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是myFunction2&quot;</span>)</span><br><span class="line"><span class="keyword">end</span>)                      <span class="comment">--可以传入时声明函数</span></span><br><span class="line"><span class="built_in">print</span>(myCoroutine2)       <span class="comment">--function: 00DBE058</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(myCoroutine2)) <span class="comment">--function</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong><font size="4">协程的执行</font></strong></p>
<ul>
<li>执行协程有两种方法 resume 和括号执行，分别对应 create 线程型和 wrap 函数型创建的协程变量。</li>
</ul>
<p><strong><font size="3">线程型 coroutine.resume(协程变量)</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- coroutine.resume(协程变量) 协程变量要是协程型</span></span><br><span class="line"><span class="built_in">coroutine</span>.<span class="built_in">resume</span>(myCoroutine1) <span class="comment">-- 我是myFunction1</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">函数型 协程变量()</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 协程变量() 协程变量要是函数型</span></span><br><span class="line">myCoroutine2() <span class="comment">-- 我是myFunction2</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">协程的挂起和分布执行</font></strong></p>
<ul>
<li>挂起协程是在函数中使用 coroutine.yield 方法并返回值，create 线程型和 wrap 函数型创建的协程变量分别使用 resume 和括号分步执行协程。</li>
</ul>
<p><strong><font size="3">挂起线程型协程 coroutine.yield(返回值1，..返回值n)和coroutine.resume(协程变量)</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--在函数中使用 coroutine.yield(返回值1，返回值2,...返回值n)</span></span><br><span class="line">myFunction3 = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">local</span> i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span></span><br><span class="line">        <span class="keyword">for</span> j = <span class="number">1</span>, <span class="number">3</span> <span class="keyword">do</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;myFunction3中打印值&quot;</span> .. <span class="string">&quot; i:&quot;</span> .. i .. <span class="string">&quot; j:&quot;</span> .. j)</span><br><span class="line">            <span class="built_in">coroutine</span>.<span class="built_in">yield</span>(i, j)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        i = i + <span class="number">1</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--使用 coroutine.create(函数变量) 创建的协程</span></span><br><span class="line"><span class="comment">--使用 coroutine.resume(协程变量) 逐步执行函数并得到当前返回值</span></span><br><span class="line"><span class="comment">--默认第一个返回值是协程是否启动成功 之后的返回值依次是函数中coroutine.yield()里的返回值</span></span><br><span class="line">myCoroutine3 = <span class="built_in">coroutine</span>.<span class="built_in">create</span>(myFunction3) <span class="comment">--线程型协程</span></span><br><span class="line">isCoroutineSuccessLaunch, tempI, tempJ = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(myCoroutine3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;线程型协程的返回值：&quot;</span>, isCoroutineSuccessLaunch, tempI, tempJ)</span><br><span class="line">isCoroutineSuccessLaunch, tempI, tempJ = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(myCoroutine3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;线程型协程的返回值：&quot;</span>, isCoroutineSuccessLaunch, tempI, tempJ)</span><br><span class="line">isCoroutineSuccessLaunch, tempI, tempJ = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(myCoroutine3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;线程型协程的返回值：&quot;</span>, isCoroutineSuccessLaunch, tempI, tempJ)</span><br><span class="line">isCoroutineSuccessLaunch, tempI, tempJ = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(myCoroutine3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;线程型协程的返回值：&quot;</span>, isCoroutineSuccessLaunch, tempI, tempJ)</span><br><span class="line">isCoroutineSuccessLaunch, tempI, tempJ = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(myCoroutine3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;线程型协程的返回值：&quot;</span>, isCoroutineSuccessLaunch, tempI, tempJ)</span><br><span class="line">isCoroutineSuccessLaunch, tempI, tempJ = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(myCoroutine3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;线程型协程的返回值：&quot;</span>, isCoroutineSuccessLaunch, tempI, tempJ)</span><br><span class="line">isCoroutineSuccessLaunch, tempI, tempJ = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(myCoroutine3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;线程型协程的返回值：&quot;</span>, isCoroutineSuccessLaunch, tempI, tempJ)</span><br><span class="line">isCoroutineSuccessLaunch, tempI, tempJ = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(myCoroutine3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;线程型协程的返回值：&quot;</span>, isCoroutineSuccessLaunch, tempI, tempJ)</span><br><span class="line">isCoroutineSuccessLaunch, tempI, tempJ = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(myCoroutine3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;线程型协程的返回值：&quot;</span>, isCoroutineSuccessLaunch, tempI, tempJ)</span><br><span class="line">isCoroutineSuccessLaunch, tempI, tempJ = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(myCoroutine3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;线程型协程的返回值：&quot;</span>, isCoroutineSuccessLaunch, tempI, tempJ)</span><br><span class="line">isCoroutineSuccessLaunch, tempI, tempJ = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(myCoroutine3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;线程型协程的返回值：&quot;</span>, isCoroutineSuccessLaunch, tempI, tempJ)</span><br><span class="line"><span class="comment">-- myFunction3中打印值 i:1 j:1</span></span><br><span class="line"><span class="comment">-- 线程型协程的返回值：	true	1	1</span></span><br><span class="line"><span class="comment">-- myFunction3中打印值 i:1 j:2</span></span><br><span class="line"><span class="comment">-- 线程型协程的返回值：	true	1	2</span></span><br><span class="line"><span class="comment">-- myFunction3中打印值 i:1 j:3</span></span><br><span class="line"><span class="comment">-- 线程型协程的返回值：	true	1	3</span></span><br><span class="line"><span class="comment">-- myFunction3中打印值 i:2 j:1</span></span><br><span class="line"><span class="comment">-- 线程型协程的返回值：	true	2	1</span></span><br><span class="line"><span class="comment">-- myFunction3中打印值 i:2 j:2</span></span><br><span class="line"><span class="comment">-- 线程型协程的返回值：	true	2	2</span></span><br><span class="line"><span class="comment">-- myFunction3中打印值 i:2 j:3</span></span><br><span class="line"><span class="comment">-- 线程型协程的返回值：	true	2	3</span></span><br><span class="line"><span class="comment">-- myFunction3中打印值 i:3 j:1</span></span><br><span class="line"><span class="comment">-- 线程型协程的返回值：	true	3	1</span></span><br><span class="line"><span class="comment">-- myFunction3中打印值 i:3 j:2</span></span><br><span class="line"><span class="comment">-- 线程型协程的返回值：	true	3	2</span></span><br><span class="line"><span class="comment">-- myFunction3中打印值 i:3 j:3</span></span><br><span class="line"><span class="comment">-- 线程型协程的返回值：	true	3	3</span></span><br><span class="line"><span class="comment">-- myFunction3中打印值 i:4 j:1</span></span><br><span class="line"><span class="comment">-- 线程型协程的返回值：	true	4	1</span></span><br><span class="line"><span class="comment">-- myFunction3中打印值 i:4 j:2</span></span><br><span class="line"><span class="comment">-- 线程型协程的返回值：	true	4	2</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">挂起函数型协程 coroutine.yield(返回值1，..返回值n)和协程变量()</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--在函数中使用 coroutine.yield(返回值1，返回值2,...返回值n)</span></span><br><span class="line">myFunction4 = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">local</span> i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span></span><br><span class="line">        <span class="keyword">for</span> j = <span class="number">1</span>, <span class="number">3</span> <span class="keyword">do</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;myFunction4中打印值&quot;</span> .. <span class="string">&quot; i:&quot;</span> .. i .. <span class="string">&quot; j:&quot;</span> .. j)</span><br><span class="line">            <span class="built_in">coroutine</span>.<span class="built_in">yield</span>(i, j)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        i = i + <span class="number">1</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--使用 coroutine.wrap(函数变量) 创建的协程</span></span><br><span class="line"><span class="comment">--使用 协程变量() 逐步执行函数并得到当前返回值</span></span><br><span class="line"><span class="comment">-- 返回值依次是函数中coroutine.yield()里的返回值 没有第一个默认的协程是否启动成功</span></span><br><span class="line">myCoroutine4 = <span class="built_in">coroutine</span>.<span class="built_in">wrap</span>(myFunction4) <span class="comment">--函数型协程</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;函数型协程的返回值：&quot;</span>, myCoroutine4())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;函数型协程的返回值：&quot;</span>, myCoroutine4())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;函数型协程的返回值：&quot;</span>, myCoroutine4())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;函数型协程的返回值：&quot;</span>, myCoroutine4())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;函数型协程的返回值：&quot;</span>, myCoroutine4())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;函数型协程的返回值：&quot;</span>, myCoroutine4())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;函数型协程的返回值：&quot;</span>, myCoroutine4())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;函数型协程的返回值：&quot;</span>, myCoroutine4())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;函数型协程的返回值：&quot;</span>, myCoroutine4())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;函数型协程的返回值：&quot;</span>, myCoroutine4())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;函数型协程的返回值：&quot;</span>, myCoroutine4())</span><br><span class="line"><span class="comment">-- myFunction4中打印值 i:1 j:1</span></span><br><span class="line"><span class="comment">-- 函数型协程的返回值：	1	1</span></span><br><span class="line"><span class="comment">-- myFunction4中打印值 i:1 j:2</span></span><br><span class="line"><span class="comment">-- 函数型协程的返回值：	1	2</span></span><br><span class="line"><span class="comment">-- myFunction4中打印值 i:1 j:3</span></span><br><span class="line"><span class="comment">-- 函数型协程的返回值：	1	3</span></span><br><span class="line"><span class="comment">-- myFunction4中打印值 i:2 j:1</span></span><br><span class="line"><span class="comment">-- 函数型协程的返回值：	2	1</span></span><br><span class="line"><span class="comment">-- myFunction4中打印值 i:2 j:2</span></span><br><span class="line"><span class="comment">-- 函数型协程的返回值：	2	2</span></span><br><span class="line"><span class="comment">-- myFunction4中打印值 i:2 j:3</span></span><br><span class="line"><span class="comment">-- 函数型协程的返回值：	2	3</span></span><br><span class="line"><span class="comment">-- myFunction4中打印值 i:3 j:1</span></span><br><span class="line"><span class="comment">-- 函数型协程的返回值：	3	1</span></span><br><span class="line"><span class="comment">-- myFunction4中打印值 i:3 j:2</span></span><br><span class="line"><span class="comment">-- 函数型协程的返回值：	3	2</span></span><br><span class="line"><span class="comment">-- myFunction4中打印值 i:3 j:3</span></span><br><span class="line"><span class="comment">-- 函数型协程的返回值：	3	3</span></span><br><span class="line"><span class="comment">-- myFunction4中打印值 i:4 j:1</span></span><br><span class="line"><span class="comment">-- 函数型协程的返回值：	4	1</span></span><br><span class="line"><span class="comment">-- myFunction4中打印值 i:4 j:2</span></span><br><span class="line"><span class="comment">-- 函数型协程的返回值：	4	2</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="4">协程的状态 coroutine.status(协程变量)</font></strong></p>
<ul>
<li>coroutine.status(协程变量) 得到当前协程的状态，并且协程变量一定要是线程型的。</li>
</ul>
<p><strong><font size="3">协程的状态有：</font></strong></p>
<ul>
<li>dead：结束</li>
<li>suspended：暂停</li>
<li>running：进行中</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">status</span>(myCoroutine1)) <span class="comment">--dead 因为myCoroutine1已经执行完毕 myCoroutine1中的函数myFunction1没有coroutine.yield方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- print(coroutine.status(myCoroutine2))--报错 因为是函数型协程</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">status</span>(myCoroutine3)) <span class="comment">--suspended myCoroutine3中的函数myFunction3有coroutine.yield方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- print(coroutine.status(myCoroutine4))--报错 因为是函数型协程</span></span><br><span class="line"></span><br><span class="line">myFunction5 = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;我是myFunction5&quot;</span>)</span><br><span class="line">    <span class="comment">--协程的挂起函数</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">status</span>(myCoroutine5)) <span class="comment">--running 因为当前协程myCoroutine5正在运行中</span></span><br><span class="line">    <span class="comment">-- print(coroutine.running())</span></span><br><span class="line">    <span class="built_in">coroutine</span>.<span class="built_in">yield</span>()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">myCoroutine5 = <span class="built_in">coroutine</span>.<span class="built_in">create</span>(myFunction5)               <span class="comment">--线程型协程</span></span><br><span class="line">isCoroutineSuccessLaunchJ = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(myCoroutine5) <span class="comment">--在函数中打印running</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">函数中得到协程的线程号 coroutine.running()</font></strong></p>
<ul>
<li>在协程装载的函数中使用 coroutine.running() 得到当前正在运行此函数的协程的线程号</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">running</span>()) <span class="comment">--nil 不在函数内</span></span><br><span class="line"></span><br><span class="line">myFunction6 = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;我是myFunction6&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">running</span>())</span><br><span class="line">        <span class="built_in">coroutine</span>.<span class="built_in">yield</span>()</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">myCoroutine61 = <span class="built_in">coroutine</span>.<span class="built_in">create</span>(myFunction6)               <span class="comment">--线程型协程</span></span><br><span class="line">isCoroutineSuccessLaunchJ = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(myCoroutine61) <span class="comment">--thread: 00DFB558</span></span><br><span class="line">isCoroutineSuccessLaunchJ = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(myCoroutine61) <span class="comment">--thread: 00DFB558</span></span><br><span class="line">isCoroutineSuccessLaunchJ = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(myCoroutine61) <span class="comment">--thread: 00DFB558</span></span><br><span class="line"><span class="comment">--resume执行的都是同一个协程 所以函数执行的线程号一样</span></span><br><span class="line"></span><br><span class="line">myCoroutine62 = <span class="built_in">coroutine</span>.<span class="built_in">wrap</span>(myFunction6)                 <span class="comment">--函数型协程</span></span><br><span class="line">myCoroutine62()                                             <span class="comment">--thread: 00C04370</span></span><br><span class="line">myCoroutine62()                                             <span class="comment">--thread: 00C04370</span></span><br><span class="line">myCoroutine62()                                             <span class="comment">--thread: 00C04370</span></span><br><span class="line"><span class="comment">--虽然括号执行的协程和resume执行的函数相同 但是因为是两个协程 所以线程号不一样</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="元表"><a href="#元表" class="headerlink" title="元表"></a>元表</h2><p><strong><font size="4">元表的概念</font></strong></p>
<ul>
<li>任何表变量都可以作为另一个表变量的元表</li>
<li>任何表变量都可以有自己的元表</li>
<li>一个表的元表可以理解为表的父表 当前表可以理解为元表的子表</li>
<li>当我们子表中进行一些特定操作时</li>
<li>会执行元表中的内容</li>
</ul>
<p><strong><font size="4">设置和得到元表</font></strong></p>
<p><strong><font size="3">设置元表方法 setmetatable(子表,元表（父表）)</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">myMetaTable1 = &#123;&#125;</span><br><span class="line">myTable1 = &#123;&#125;</span><br><span class="line"><span class="built_in">setmetatable</span>(myTable1, myMetaTable1)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>setmetatable其实有返回值，返回的是myTable1这个表本身。</li>
</ul>
<p><strong><font size="3">得到元表方法 getmetatable(子表)</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">getmetatable</span>(myTable1)) <span class="comment">--table: 00B91AF0</span></span><br><span class="line"><span class="built_in">print</span>(myMetaTable1)           <span class="comment">--table: 00B91AF0</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="3">元表的__tostring方法 子表当成字符串时用到</font></strong></p>
<ul>
<li>当子表要被当做字符串使用时 会默认调用子表的元表中的__tostring方法</li>
<li>比如直接打印输出表时 就会调用元表中的tostring方法</li>
<li>元表的__tostring函数变量可以选择有没有参数</li>
<li>没参数的话直接返回字符串即可</li>
<li>有参数的话参数默认传的是子表当参数</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">myMetaTable2 = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 无参函数</span></span><br><span class="line">    <span class="comment">-- __tostring = function()</span></span><br><span class="line">    <span class="comment">-- 	return &quot;奥特曼1&quot;</span></span><br><span class="line">    <span class="comment">-- end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 有参函数</span></span><br><span class="line">    <span class="built_in">__tostring</span> = <span class="function"><span class="keyword">function</span><span class="params">(sonTable)</span></span></span><br><span class="line">        <span class="keyword">return</span> sonTable.name</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line">myTable2 = &#123;</span><br><span class="line">    name = <span class="string">&quot;奥特曼2&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">setmetatable</span>(myTable2, myMetaTable2)</span><br><span class="line"><span class="built_in">print</span>(myTable2) <span class="comment">--奥特曼2 因为是有参函数</span></span><br><span class="line"><span class="comment">-- 如果元表的__tostring使用的是无参函数变量的话就是奥特曼1 </span></span><br><span class="line"><span class="comment">-- 如果元表的__tostring为空会打印表信息table: 00CBA480</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="3">元表的__call方法 子表当成函数时用到</font></strong></p>
<ul>
<li>当子表被当做一个函数来使用时 会默认调用子表的元表中的___call方法</li>
<li>如果子表被当做一个函数来使用时但子表的元表中的___call方法没有被实现 会报错</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">myMetaTable3 = &#123;</span><br><span class="line">    <span class="comment">--__call方法的第一个参数 是元表的子表</span></span><br><span class="line">    <span class="built_in">__call</span> = <span class="function"><span class="keyword">function</span><span class="params">(sonTable, parameter1, parameter2)</span></span></span><br><span class="line">        <span class="built_in">print</span>(sonTable) <span class="comment">--把子表当做字符串使用 假如当前元表没有__tostring方法就直接打印表变量</span></span><br><span class="line">        <span class="built_in">print</span>(parameter1)</span><br><span class="line">        <span class="built_in">print</span>(parameter2)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;奥特曼机甲&quot;</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myTable3 = &#123;</span><br><span class="line">    name = <span class="string">&quot;奥特曼3&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">setmetatable</span>(myTable3, myMetaTable3)</span><br><span class="line"></span><br><span class="line">myTable3(<span class="string">&quot;一刀999&quot;</span>, <span class="string">&quot;两刀666&quot;</span>)</span><br><span class="line"><span class="comment">-- table: 00BA2830</span></span><br><span class="line"><span class="comment">-- 一刀999</span></span><br><span class="line"><span class="comment">-- 两刀666</span></span><br><span class="line"><span class="comment">-- 奥特曼机甲</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">元表的运算重载方法 子表做运算时用到</font></strong></p>
<ul>
<li>当子表和别的表做运算符操作时时 会默认调用子表的元表中的一些运算符方法 相当于运算符重载</li>
<li>运算符方法第一个参数是当前子表 第二个参数是和子表操作的表</li>
<li>注意:子表和别的表使用条件运算符做操作时 子表和别的表要共享同一个元表 即别的表的元表也要设置成当前子表的元表 否则使用条件运算符报错</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">myMetaTable4 = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">--运算符+</span></span><br><span class="line">    <span class="built_in">__add</span> = <span class="function"><span class="keyword">function</span><span class="params">(table1, table2)</span></span></span><br><span class="line">        <span class="keyword">return</span> table1.age + table2.age</span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">--运算符-</span></span><br><span class="line">    <span class="built_in">__sub</span> = <span class="function"><span class="keyword">function</span><span class="params">(table1, table2)</span></span></span><br><span class="line">        <span class="keyword">return</span> table1.age - table2.age</span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">--运算符*</span></span><br><span class="line">    <span class="built_in">__mul</span> = <span class="function"><span class="keyword">function</span><span class="params">(table1, table2)</span></span></span><br><span class="line">        <span class="keyword">return</span> table1.age * table2.age</span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">--运算符/</span></span><br><span class="line">    <span class="built_in">__div</span> = <span class="function"><span class="keyword">function</span><span class="params">(table1, table2)</span></span></span><br><span class="line">        <span class="keyword">return</span> table1.age / table2.age</span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">--运算符%</span></span><br><span class="line">    <span class="built_in">__mod</span> = <span class="function"><span class="keyword">function</span><span class="params">(table1, table2)</span></span></span><br><span class="line">        <span class="keyword">return</span> table1.age % table2.age</span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">--运算符^</span></span><br><span class="line">    <span class="built_in">__pow</span> = <span class="function"><span class="keyword">function</span><span class="params">(table1, table2)</span></span></span><br><span class="line">        <span class="keyword">return</span> table1.age ^ table2.age</span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">--运算符==</span></span><br><span class="line">    <span class="built_in">__eq</span> = <span class="function"><span class="keyword">function</span><span class="params">(table1, table2)</span></span></span><br><span class="line">        <span class="keyword">return</span> table1.age == table2.age</span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">--运算符&lt;</span></span><br><span class="line">    <span class="built_in">__lt</span> = <span class="function"><span class="keyword">function</span><span class="params">(table1, table2)</span></span></span><br><span class="line">        <span class="keyword">return</span> table1.age &lt; table2.age</span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">--运算符&lt;=</span></span><br><span class="line">    <span class="built_in">__le</span> = <span class="function"><span class="keyword">function</span><span class="params">(table1, table2)</span></span></span><br><span class="line">        <span class="keyword">return</span> table1.age &lt;= table2.age</span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">--运算符..</span></span><br><span class="line">    <span class="built_in">__concat</span> = <span class="function"><span class="keyword">function</span><span class="params">(table1, table2)</span></span></span><br><span class="line">        <span class="keyword">return</span> table1.age .. table2.age</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myTable41 = &#123; age = <span class="number">100</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">setmetatable</span>(myTable41, myMetaTable4)</span><br><span class="line"></span><br><span class="line">myTable42 = &#123; age = <span class="number">10</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myTable41 + myTable42)          <span class="comment">--110</span></span><br><span class="line"><span class="built_in">print</span>(myTable41 - myTable42)          <span class="comment">--90</span></span><br><span class="line"><span class="built_in">print</span>(myTable41 * myTable42)          <span class="comment">--1000</span></span><br><span class="line"><span class="built_in">print</span>(myTable41 / myTable42)          <span class="comment">--19</span></span><br><span class="line"><span class="built_in">print</span>(myTable41 % myTable42)          <span class="comment">--0</span></span><br><span class="line"><span class="built_in">print</span>(myTable41 ^ myTable42)          <span class="comment">--1e+020</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">setmetatable</span>(myTable42, myMetaTable4) <span class="comment">--为了使用条件运算符比较 两个表的元表必须是同一个表 否则报错</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myTable41 == myTable42)         <span class="comment">--false</span></span><br><span class="line"><span class="built_in">print</span>(myTable41 &gt; myTable42)          <span class="comment">--true</span></span><br><span class="line"><span class="built_in">print</span>(myTable41 &lt;= myTable42)         <span class="comment">--false</span></span><br><span class="line"><span class="built_in">print</span>(myTable41 .. myTable42)         <span class="comment">--10010</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="4">元表的__index表 子表得到某属性时用到</font></strong></p>
<ul>
<li>当子表中想得某一个属性 但找不到对应属性时 会到子表的元表中找__index表变量中有没有对应属性</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">myMetaTable5 = &#123;</span><br><span class="line">    <span class="built_in">__index</span> = &#123; name = <span class="string">&quot;奥特曼5&quot;</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myTable5 = &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">setmetatable</span>(myTable5, myMetaTable5)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myTable5.name) <span class="comment">--奥特曼5 myTable5中没有name 去myMetaTable5中找到__index指向的表 得到里面的name的值</span></span><br><span class="line"></span><br><span class="line">myMetaTable5.<span class="built_in">__index</span> = &#123; name = <span class="string">&quot;奥特曼55&quot;</span> &#125; <span class="comment">--也可以在外面赋值元表的__index变量</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myTable5.name) <span class="comment">--奥特曼55  myMetaTable5在外面重新设置了__index指向的表</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>注意：有个小坑 假如元表的__index表变量指向的是自己 假如直接在元表内部声明会打印nil</li>
<li>所以假如元表的__index指向的是自己建议在外部赋值</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">myMetaTable6 = &#123;</span><br><span class="line">    name = <span class="string">&quot;奥特曼6&quot;</span>,</span><br><span class="line">    <span class="built_in">__index</span> = myMetaTable6</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myTable6 = &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">setmetatable</span>(myTable6, myMetaTable6)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myTable6.name)                <span class="comment">--nil</span></span><br><span class="line"></span><br><span class="line">myMetaTable6.<span class="built_in">__index</span> = myMetaTable6 <span class="comment">--元表的__index指向的是自己建议在外部赋值</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myTable6.name)                <span class="comment">--奥特曼6</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>元表中的__index表变量假如没有对应属性 那么会嵌套的去元表的元表的的__index表变量中找对应属性 还可以一起继续一层一层往上找 直到找不到</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">myMetaTable7Father = &#123;</span><br><span class="line">    name = <span class="string">&quot;奥特曼7&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myMetaTable7 = &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myTable7 = &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">setmetatable</span>(myTable7, myMetaTable7)</span><br><span class="line"></span><br><span class="line"><span class="built_in">setmetatable</span>(myMetaTable7, myMetaTable7Father)</span><br><span class="line"></span><br><span class="line">myMetaTable7.<span class="built_in">__index</span> = myMetaTable7 <span class="comment">--假如myTable7找不到属性去myMetaTable7的__index表变量找 即myMetaTable7自己</span></span><br><span class="line"></span><br><span class="line">myMetaTable7Father.<span class="built_in">__index</span> =</span><br><span class="line">    myMetaTable7Father              <span class="comment">--假如myMetaTable7还找不到属性去myMetaTable7Father的__index表变量找 即myMetaTable7Father自己</span></span><br><span class="line"><span class="built_in">print</span>(myTable7.name)                <span class="comment">--奥特曼7</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>不查询元表中的__index表方法 rawget(子表, “要查询的属性”)</li>
<li>该方法只会在子表中查找 子表没有就没有了 不会去元表查找__index表了</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myTable7.name) <span class="comment">--奥特曼7 元表的__index表有name属性</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">rawget</span>(myTable7, <span class="string">&quot;name&quot;</span>)) <span class="comment">--nil 子表没有name属性</span></span><br><span class="line"></span><br><span class="line">myTable7.name = <span class="string">&quot;奥特曼777&quot;</span> <span class="comment">--子表设置name属性</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">rawget</span>(myTable7, <span class="string">&quot;name&quot;</span>)) <span class="comment">--奥特曼777 找到了子表的name属性</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myTable7.name) <span class="comment">--奥特曼7  找到了子表的name属性就不去找元表了</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>元表的 __index 可以是一个函数</li>
<li>如果是函数，它会在子表中找不到属性时被调用，并传入两个参数：子表（触发元方法的表）和访问的键。</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">myMetaTableIndexFunc = &#123;</span><br><span class="line">    <span class="built_in">__index</span> = <span class="function"><span class="keyword">function</span><span class="params">(table, key)</span></span></span><br><span class="line">        <span class="keyword">if</span> key == <span class="string">&quot;greeting&quot;</span> <span class="keyword">then</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Hello from function!&quot;</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Key not found&quot;</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line">myTableIndexFunc = &#123;&#125;</span><br><span class="line"><span class="built_in">setmetatable</span>(myTableIndexFunc, myMetaTableIndexFunc)</span><br><span class="line"><span class="built_in">print</span>(myTableIndexFunc.greeting) <span class="comment">-- Hello from function!</span></span><br><span class="line"><span class="built_in">print</span>(myTableIndexFunc.otherKey) <span class="comment">-- Key not found</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="4">元表的__newIndex表 子表改某一个属性赋值时用到</font></strong></p>
<ul>
<li>当子表中想改某一个属性并赋值 但找不到对应属性时 会把这个属性赋值到元表的__newindex所指的表中 不会修改子表</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">myMetaTable8 = &#123;&#125;</span><br><span class="line"></span><br><span class="line">myMetaTable8.<span class="built_in">__newindex</span> = &#123;&#125;</span><br><span class="line"></span><br><span class="line">myTable8 = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">setmetatable</span>(myTable8, myMetaTable8)</span><br><span class="line"></span><br><span class="line">myTable8.name = <span class="string">&quot;奥特曼8&quot;</span> <span class="comment">--设置了一个myTable7本来并不存在的属性name</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myTable8.name) <span class="comment">-- nil 因为myTable8的元表myMetaTable8中存在__newindex表变量</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myMetaTable8.<span class="built_in">__newindex</span>.name) <span class="comment">--奥特曼8 name赋值到元表的__newinde表</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>不修改元表中的__newIndex表方法 rawset(子表, “要设置的属性”, 属性值)</li>
<li>该方法只会在子表设置属性 子表没有该属性 不会去元表设置到__newIndex表上了</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myTable8.age)                <span class="comment">--nil myTable8现在没有age属性</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">rawset</span>(myTable8, <span class="string">&quot;age&quot;</span>, <span class="number">22</span>)        <span class="comment">--设置age属性到子表</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myMetaTable8.<span class="built_in">__newindex</span>.age) <span class="comment">--nil 元表的__newindex找不到age属性 没有设置到元表的__newindex表中</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myTable8.age)                <span class="comment">--22 子表有age属性了</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>元表的 __newindex 也可以是一个函数</li>
<li>如果是函数，它会在子表中赋值属性时被调用，并传入三个参数：子表（触发元方法的表）和访问的键和值。</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">myMetaTableNewIndexFunc = &#123;</span><br><span class="line">    <span class="built_in">__newindex</span> = <span class="function"><span class="keyword">function</span><span class="params">(table, key, value)</span></span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Trying to set &quot;</span> .. key .. <span class="string">&quot; to &quot;</span> .. value)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line">myTableNewIndexFunc = &#123;&#125;</span><br><span class="line"><span class="built_in">setmetatable</span>(myTableNewIndexFunc, myMetaTableNewIndexFunc)</span><br><span class="line">myTableNewIndexFunc.name = <span class="string">&quot;ATM&quot;</span> <span class="comment">-- Trying to set name to ATM</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h2><p><strong><font size="4">封装</font></strong></p>
<ul>
<li>Lua中的面向对象 类 其实都是基于表来实现 并且会结合元表相关的知识点</li>
</ul>
<p><strong><font size="3">创建万物之父类 Object表</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Object = &#123;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">给万物之父手动添加实例化的new方法</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 使用到的知识：在类外使用:在类外添加的成员方法 </span></span><br><span class="line"><span class="comment">--由于Lua中的类（表）是类似c#中的静态类 没有实例化方法 所以我们要给万物之父手动添加实例化方法</span></span><br><span class="line"><span class="comment">--万物之父设置实例化方法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Object:new</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">--实例化方法的目的是返回一个新的对象 对象就是变量</span></span><br><span class="line">    <span class="comment">--Lua中的对象可以理解为返回一个表变量</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">local</span> obj = &#123;&#125;       <span class="comment">--要实例化的对象 表变量 防止全局定义 要是局部变量</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">setmetatable</span>(obj, <span class="built_in">self</span>) <span class="comment">--设置万物之父是当前实例化对象的元表</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">self</span>.<span class="built_in">__index</span> = <span class="built_in">self</span>  <span class="comment">--设置万物之父的__index表是万物之父自己 这样实例化对象找不到属性的时候可以去万物之父中找</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> obj           <span class="comment">--返回对象</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">给万物之父设置一个属性id</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Object.id = <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">给万物之父设置打印id属性的方法</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Object:PrintId</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">self</span>.id)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">实例化对象并使用</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">local</span> myObj = Object:new() <span class="comment">--实例化对象</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myObj)               <span class="comment">--table: 00BAA670 对象本质是表</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myObj.id)            <span class="comment">--1 myObj其实是没有id属性的 是去myObj的元表Object的_index指向的Object中找的id属性</span></span><br><span class="line"><span class="comment">--模拟对象实例化后属性没有设置默认值 那么就是类中属性自带的默认值 这个默认值是去元表元表Object的_index指向的Object中找</span></span><br><span class="line"></span><br><span class="line">myObj:PrintId()            <span class="comment">--1  myObj其实是没有PrintId方法的 是在PrintId方法中去myObj的元表Object的_index指向的Object中找的PrintId方法并调用</span></span><br><span class="line"><span class="comment">--模拟对象实例化调用类中封装的方法</span></span><br><span class="line"></span><br><span class="line">myObj.id = <span class="number">2</span>               <span class="comment">--给当前对象也设置一个属性叫id</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(Object.id)           <span class="comment">--1 仍然是1 不会改动到Object</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myObj.id)            <span class="comment">--2 因为myObj设置了属性id 不会去找myObj的元表Object的_index指向的Object</span></span><br><span class="line"><span class="comment">--模拟对象实例化后属性设置了默认值 那就不去类中找默认值了 用自己赋值的</span></span><br><span class="line"></span><br><span class="line">myObj:PrintId()            <span class="comment">--2  myObj其实仍然是没有PrintId方法的 但是传入了myObj作为参数 在PrintId方法中 因为myObj设置了属性id可以直接输出</span></span><br><span class="line"><span class="comment">--PrintId方法仍然用类公有的PrintId方法 但是值已经是自己设置的了</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">继承</font></strong></p>
<p><strong><font size="3">回顾_G表</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--继承要用到_G表的知识 _G本质上是一个表 以键值对的形式存储了所以全局变量</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">_G</span>) <span class="comment">--table: 00D54F00  _G本质上是一个表</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 设置全局变量 a 的初始值为 111</span></span><br><span class="line"><span class="built_in">_G</span>[<span class="string">&quot;a&quot;</span>] = <span class="number">111</span></span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment">-- 输出 111</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改全局变量 a 的值为 222</span></span><br><span class="line"><span class="built_in">_G</span>.a = <span class="number">222</span></span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment">-- 输出 222</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 尝试将全局变量 a 的值作为键，设置 _G 表中的键为 222 的值为 333</span></span><br><span class="line"><span class="comment">-- 注意：这不会改变全局变量 a 的值</span></span><br><span class="line"><span class="built_in">_G</span>[a] = <span class="number">333</span></span><br><span class="line"><span class="built_in">print</span>(a)       <span class="comment">-- 输出 222</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">_G</span>[<span class="number">222</span>]) <span class="comment">-- 输出 333</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改全局变量 a 的值为字符串 &quot;a&quot;</span></span><br><span class="line"><span class="built_in">_G</span>.a = <span class="string">&quot;a&quot;</span></span><br><span class="line"><span class="built_in">print</span>(a)     <span class="comment">-- 输出 &quot;a&quot;，全局变量 a 的值是字符串 &quot;a&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">_G</span>[a]) <span class="comment">-- 输出 &quot;a&quot;，这样写等同于 _G[&quot;a&quot;] 因为a=&quot;a&quot; 所以其实就是_G[&quot;a&quot;]</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="3">给万物之父设置继承的方法 要传入子类名 要双引号包裹</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Object:subClass</span><span class="params">(className)</span></span></span><br><span class="line">    <span class="comment">--继承的目的是设置传入表和调用继承方法表之前的继承关系 继承关系通过元表建立</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">--把传进来的子类 在_G中为传入来的类名设置全局变量 初始为空表</span></span><br><span class="line">    <span class="built_in">_G</span>[className] = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">--使用元表建立继承规则的关联</span></span><br><span class="line">    <span class="built_in">_G</span>[className].base = <span class="built_in">self</span>      <span class="comment">--base代表父类属性 self代表Object 设置子类的父类属性为Object</span></span><br><span class="line">    <span class="built_in">setmetatable</span>(<span class="built_in">_G</span>[className], <span class="built_in">self</span>) <span class="comment">--设置子类的元表是Object万物之父</span></span><br><span class="line">    <span class="built_in">self</span>.<span class="built_in">__index</span> = <span class="built_in">self</span>            <span class="comment">--设置万物之父的__index表是万物之父自己 这样子类找不到的属性和方法可以去Object中找</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="3">子类继承万物之父Object</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Object:subClass(<span class="string">&quot;Person&quot;</span>)    <span class="comment">--子类Person继承万物之父Object</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(Person)                <span class="comment">--table: 00E5A4B8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> person1 = Person:new() <span class="comment">--实例化Person</span></span><br><span class="line"><span class="comment">-- Person现在是空表 没有new方法</span></span><br><span class="line"><span class="comment">-- 去Person的元表Object的__index指向的表Object中找 发现有new方法</span></span><br><span class="line"><span class="comment">-- new方法会把Person作为第一个参数传进去 Person的__index设置成Person自己</span></span><br><span class="line"><span class="comment">-- 返回一个实例化Person的对象 并且元表是Person</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(person1.id) <span class="comment">--1 person1现在是空表</span></span><br><span class="line"><span class="comment">-- 去元表Person的__index指向的表Person中发现也没有id 再上一层去Person的元表Object的__index指向的表Object中找 发现有id属性 返回id属性</span></span><br><span class="line"></span><br><span class="line">person1.id = <span class="number">100</span></span><br><span class="line"><span class="built_in">print</span>(person1.id)          <span class="comment">--100 person1表有了id属性</span></span><br><span class="line"></span><br><span class="line">person1:PrintId()          <span class="comment">--100 person1没有:PrintId()方法 会一直找到Object发现有PrintId方法 传入自身person1作为参数 打印自身的id属性 刚刚设置了100</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Object:subClass(<span class="string">&quot;Monster&quot;</span>) <span class="comment">--另一子类Monster和Person类似</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> monster1 = Monster:new()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(monster1.id)         <span class="comment">--1</span></span><br><span class="line"></span><br><span class="line">monster1.id = <span class="number">200</span></span><br><span class="line"><span class="built_in">print</span>(monster1.id)         <span class="comment">--200</span></span><br><span class="line"></span><br><span class="line">monster1:PrintId()         <span class="comment">--200</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">多态</font></strong></p>
<ul>
<li>相同行为 不同表现 就是多态</li>
<li>相同方法 不同执行逻辑 就是多态</li>
</ul>
<p><strong><font size="3">创建继承万物之父的GameObject类</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Object:subClass(<span class="string">&quot;GameObject&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">--设置GameObject的坐标属性</span></span><br><span class="line">GameObject.posX = <span class="number">0</span>;</span><br><span class="line">GameObject.posY = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--设置GameObject移动方法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GameObject:Move</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">self</span>.posX = <span class="built_in">self</span>.posX + <span class="number">1</span></span><br><span class="line">    <span class="built_in">self</span>.posY = <span class="built_in">self</span>.posY + <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">self</span>.posX)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">self</span>.posY)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">创建继承GameObject类的Player类</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">GameObject:subClass(<span class="string">&quot;Player&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">--设置Player的移动方法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Player:Move</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">--Player继承GameObject 所以Player存在base属性 base是GameObject 表（类）</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">--Player正常会要调用基类GameObject的移动方法</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">--如果使用冒号调用GameObject的移动方法 会把GameObject作为第一个参数传入到移动方法中</span></span><br><span class="line">    <span class="comment">--这样实例化的任何Player对象 共用同一张GameObject表的属性 </span></span><br><span class="line">    <span class="comment">--有点修改的是静态变量的意思 而不是对象自身的变量</span></span><br><span class="line">    <span class="comment">-- self.base:Move()--存在问题</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">--如果要执行父类的逻辑 我们不要直接使用冒号调用 要通过.调用 </span></span><br><span class="line">    <span class="comment">--然后传入自己作为第一个参数 </span></span><br><span class="line">    <span class="comment">--GameObject的移动方法中的self意味着传入方法中的第一个参数 </span></span><br><span class="line">    <span class="comment">--这样在GameObject的移动方法中的self会是实例化出来的player</span></span><br><span class="line">    <span class="built_in">self</span>.base.Move(<span class="built_in">self</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> player1 = Player:new()</span><br><span class="line">player1:Move()<span class="comment">--1 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> player2 = Player:new()</span><br><span class="line">player2:Move()<span class="comment">--1 1 不会影响到player1</span></span><br><span class="line"></span><br><span class="line">player1:Move()<span class="comment">--2 2 </span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="自带库"><a href="#自带库" class="headerlink" title="自带库"></a>自带库</h2><p><strong><font size="4">时间</font></strong></p>
<ul>
<li>os.time() 系统时间戳</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">os</span>.<span class="built_in">time</span>())                                     <span class="comment">--1695818702</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>os.time({ year &#x3D; 年, month &#x3D; 月, day &#x3D; 日 }) 传入时间相关的参数得到时间戳</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">os</span>.<span class="built_in">time</span>(&#123; year = <span class="number">2014</span>, month = <span class="number">8</span>, day = <span class="number">14</span> &#125;)) <span class="comment">--1407988800</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>os.date(“*t”) 返回当前时间的表对象</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">local</span> nowTime = <span class="built_in">os</span>.<span class="built_in">date</span>(<span class="string">&quot;*t&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(nowTime) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(k, v)</span><br><span class="line">    <span class="comment">-- hour	20</span></span><br><span class="line">    <span class="comment">-- min	45</span></span><br><span class="line">    <span class="comment">-- wday	4</span></span><br><span class="line">    <span class="comment">-- day	27</span></span><br><span class="line">    <span class="comment">-- month	9</span></span><br><span class="line">    <span class="comment">-- year	2023</span></span><br><span class="line">    <span class="comment">-- sec	2</span></span><br><span class="line">    <span class="comment">-- yday	270</span></span><br><span class="line">    <span class="comment">-- isdst	false</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">数学运算</font></strong></p>
<ul>
<li>math.abs(数值) 绝对值</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">math</span>.<span class="built_in">abs</span>(<span class="number">-1</span>))      <span class="comment">-- 1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>math.deg(数值) 传入弧度转角度</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">math</span>.<span class="built_in">deg</span>(<span class="built_in">math</span>.<span class="built_in">pi</span>)) <span class="comment">-- 180</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>math.cos(数值) 三角函数 传弧度</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">math</span>.<span class="built_in">cos</span>(<span class="built_in">math</span>.<span class="built_in">pi</span>)) <span class="comment">-- -1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>math.floor(数值) 向下取整</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">math</span>.<span class="built_in">floor</span>(<span class="number">2.6</span>))   <span class="comment">-- 2</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>math.ceil(数值) 向上取整</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">math</span>.<span class="built_in">ceil</span>(<span class="number">5.2</span>))    <span class="comment">-- 6</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>math.max(数值1, 数值2) 最大值</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">math</span>.<span class="built_in">max</span>(<span class="number">1</span>, <span class="number">2</span>))    <span class="comment">-- 2</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>math.min(数值1, 数值2) 最小值</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">math</span>.<span class="built_in">min</span>(<span class="number">4</span>, <span class="number">5</span>))    <span class="comment">-- 4</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>math.modf(数值) 把数值分离分成整数部分和小数部分并返回</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">math</span>.<span class="built_in">modf</span>(<span class="number">1.2</span>))    <span class="comment">-- 1	0.2</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>math.pow(底数, 幂) 幂运算</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">math</span>.<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">5</span>))    <span class="comment">--32</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>math.randomseed(任何数值) 设置随机数种子</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">math</span>.<span class="built_in">randomseed</span>(<span class="built_in">os</span>.<span class="built_in">time</span>())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>math.random(最大值) 返回随机数 随机前要设置随机数种子 不然每次随机出来的数都一样</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">100</span>)) <span class="comment">--20 不是随机的 相同的随机数种子每次运行第一次随机出来都相同</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">100</span>)) <span class="comment">--98 随机的</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>math.sqrt(底数) 开方</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">math</span>.<span class="built_in">sqrt</span>(<span class="number">4</span>))     <span class="comment">--2</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="4">路径</font></strong></p>
<ul>
<li>package.path lua脚本加载路径</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">package</span>.<span class="built_in">path</span>)                    <span class="comment">-- ;.\?.lua;C:\Program Files (x86)\Lua\5.1\lua\?.lua;C:\Program Files (x86)\Lua\5.1\lua\?\init.lua;C:\Program Files (x86)\Lua\5.1\?.lua;C:\Program Files (x86)\Lua\5.1\?\init.lua;C:\Program Files (x86)\Lua\5.1\lua\?.luac</span></span><br><span class="line"><span class="built_in">package</span>.<span class="built_in">path</span> = <span class="built_in">package</span>.<span class="built_in">path</span> .. <span class="string">&quot;;C:\\&quot;</span> <span class="comment">--可以进行拼接</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">package</span>.<span class="built_in">path</span>)                    <span class="comment">--;.\?.lua;C:\Program Files (x86)\Lua\5.1\lua\?.lua;C:\Program Files (x86)\Lua\5.1\lua\?\init.lua;C:\Program Files (x86)\Lua\5.1\?.lua;C:\Program Files (x86)\Lua\5.1\?\init.lua;C:\Program Files (x86)\Lua\5.1\lua\?.luac;C:\</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="垃圾回收"><a href="#垃圾回收" class="headerlink" title="垃圾回收"></a>垃圾回收</h2><p><strong><font size="4">垃圾回收机制详解</font></strong></p>
<ul>
<li>Lua 从 5.1 版本起就采用了增量式标记-清除（incremental mark-and-sweep）的垃圾回收策略，并在 5.4 版本中引入了分代式回收（generational GC）以进一步优化短命对象的回收效率。下面分几点来说明其工作原理及可调参数。</li>
</ul>
<p><strong><font size="3">垃圾回收的基本概念</font></strong></p>
<ul>
<li>自动内存管理：Lua 会自动跟踪所有在 Lua 空间中创建的对象（字符串、表、函数、userdata、线程等），不再由程序员手动 malloc&#x2F;free；</li>
<li>“可达性”决定存活：只要一个对象能从全局变量、栈或 C 变量链路追溯到，它就被认为是“可达”（alive）；否则就成为“垃圾”（dead）([lua.org][1])。</li>
</ul>
<p><strong><font size="4">增量式三色标记-清除（Incremental Mark-and-Sweep）</font></strong></p>
<p><strong><font size="3">三色标记状态的含义</font></strong></p>
<ul>
<li>在增量式标记阶段，Lua 使用“白—灰—黑”三色机制来追踪对象状态：</li>
</ul>
<p>白色（White）</p>
<ul>
<li>含义：尚未被标记为“可达”，也就是尚未检查的对象。</li>
<li>初始状态：所有堆上分配的对象在一轮 GC 开始时都先标记为白色。</li>
<li>最终命运：如果在标记阶段结束时仍保持白色，则被认为不可达，在清除阶段会被回收。</li>
</ul>
<p>灰色（Gray）</p>
<ul>
<li>含义：已知为可达，需要进一步“扫”它所引用的子对象。</li>
<li>转变时机：<br>1.GC 从根集合（如全局表、Lua 栈、注册表）扫描，并将每个可达的白色对象标记为灰色。<br>2.在后续的小步增量标记中，每当一个灰色对象被“处理”时，它本身会变为黑色，同时将它引用的所有白色子对象标记为灰色。</li>
</ul>
<p>黑色（Black）</p>
<ul>
<li>含义：不仅自身已被确认可达，且其所有直接引用的子对象都已至少被标记为灰色（即排除了它指向任何白色对象）。</li>
<li>转变时机：当一个灰色对象在某次标记子步中被“扫描”后，它被涂成黑色。</li>
</ul>
<p><strong><font size="4">状态流转示例</font></strong></p>
<p><strong><font size="3">1.标记（Mark）阶段</font></strong></p>
<p>1.GC 开始</p>
<ul>
<li>所有对象：白色。</li>
<li>根集合引用的对象 → 标记为灰色。</li>
</ul>
<p>2.处理灰色队列（多次小步）：</p>
<ul>
<li>取出一个灰色对象 A：</li>
<li>扫描 A 引用的每个子对象 B：</li>
<li>若 B 是白色 → 标记为灰色。</li>
<li>将 A 本身标记为黑色。</li>
</ul>
<p>3.标记阶段结束</p>
<ul>
<li>灰色队列清空，剩余的灰色对象（理论上无）全部变黑。</li>
<li>白色对象即为不可达对象。</li>
</ul>
<p><strong><font size="3">2.清除（Sweep）阶段</font></strong><br>扫描所有对象：</p>
<ul>
<li>白色 → 释放内存；</li>
<li>黑色 → 重置为白色，为下一轮 GC 做准备。</li>
</ul>
<p><strong><font size="3">3.分步执行</font></strong></p>
<ul>
<li>将标记与清除拆成若干小步，与普通程序执行交替，避免长时间停顿；</li>
</ul>
<p><strong><font size="3">4.原子阶段（Atomic）</font></strong></p>
<ul>
<li>当内存达到一定阈值时，执行一次完整、不可中断的标记-清除，以保证无遗留死对象。</li>
</ul>
<p><strong><font size="4">分代式垃圾回收（5.4+）</font></strong></p>
<p><strong><font size="3">Lua 5.4 在上述基础上引入了两代区：</font></strong></p>
<p>新生代（Young）</p>
<ul>
<li>存放刚创建的对象；</li>
<li>回收频率高，快速回收短命对象。</li>
</ul>
<p>老生代（Old）</p>
<ul>
<li>存放多次新生代回收后仍存活的对象；</li>
<li>回收频率低，减少对长寿对象的重复扫描。</li>
</ul>
<p>晋升策略</p>
<ul>
<li>在多次 Minor GC 后仍存活的新生代对象会被晋升到老生代；</li>
<li>Major GC（全堆回收）同时扫描新生代与老生代。</li>
</ul>
<p><strong><font size="4">垃圾回收机制其它特性</font></strong></p>
<p><strong><font size="3">弱引用表与缓存、循环引用</font></strong></p>
<p>什么是弱引用表</p>
<ul>
<li>在 Lua 中，普通的表（table）对键（key）和值（value）都会保持“强引用”——只要表还存在，对应的键、值就不会被垃圾回收器（GC）回收。</li>
<li>如果我们希望“让表不阻止某些对象被回收”，就要用“弱引用表”。</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">local</span> t = <span class="built_in">setmetatable</span>(&#123;&#125;, &#123; <span class="built_in">__mode</span> = <span class="string">&quot;v&quot;</span> &#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>__mode &#x3D; “v”：告诉 Lua “这个表的值（value）是弱引用”。</li>
<li>如果把一个对象放到这个表的 value 里，且它在程序其他地方没有任何强引用了，那么当 GC 运行时，这个对象就会被回收，表中对应的 value 就会变成 nil。</li>
</ul>
<blockquote>
<p>同理，__mode &#x3D; “k” 会让键变成弱引用，__mode &#x3D; “kv”（或 “vk”）则是键、值都弱引用。</p>
</blockquote>
<p><strong><font size="4">缓存示例详解</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 创建一个值为弱引用的缓存表</span></span><br><span class="line"><span class="keyword">local</span> cache = <span class="built_in">setmetatable</span>(&#123;&#125;, &#123; <span class="built_in">__mode</span> = <span class="string">&quot;v&quot;</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">expensiveComputation</span><span class="params">(obj)</span></span></span><br><span class="line">    <span class="comment">-- 假设这是一个昂贵计算，返回一个结果表</span></span><br><span class="line">    <span class="keyword">return</span> &#123; /* ... 复杂数据 ... */ &#125;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCachedResult</span><span class="params">(obj)</span></span></span><br><span class="line">    <span class="comment">-- 1. 先从 cache[obj] 取：如果有缓存且尚未被回收，就直接用</span></span><br><span class="line">    <span class="keyword">local</span> result = cache[obj]</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> result <span class="keyword">then</span></span><br><span class="line">        <span class="comment">-- 2. 否则重新计算，并把结果放入 cache</span></span><br><span class="line">        result = expensiveComputation(obj)</span><br><span class="line">        cache[obj] = result</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用示例</span></span><br><span class="line"><span class="keyword">local</span> myObject = &#123;&#125;</span><br><span class="line"><span class="keyword">local</span> r1 = getCachedResult(myObject)   <span class="comment">-- 计算并缓存</span></span><br><span class="line"><span class="keyword">local</span> r2 = getCachedResult(myObject)   <span class="comment">-- 直接从 cache 取，不再重复计算</span></span><br><span class="line"><span class="comment">-- 后续如果程序中再也没有其他变量引用 r1/r2（即只有 cache 持有），GC 依旧会回收那个结果表</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong><font size="3">要点</font></strong></p>
<p>1.缓存表不阻止结果被回收</p>
<ul>
<li>因为 cache 的 value 是弱引用，GC 看到一个“只在弱表里”的结果对象时，就会回收它。</li>
</ul>
<p>2.避免内存无限增长</p>
<ul>
<li>普通缓存如果不手动清理，可能导致内存按用过的 key 越积越多；弱引用表则自动让不再需要的缓存对象释放掉。</li>
</ul>
<p>3.对 key（obj）的引用依然是强的</p>
<ul>
<li>只有 value 是弱引用，所以只要 obj 本身还在用，cache[obj] 这个键还存在；但对应的值可能是 nil，这样下次调用就会重新计算。</li>
</ul>
<p><strong><font size="4">使用弱表打破循环引用</font></strong></p>
<p><strong><font size="3">1.循环引用问题</font></strong></p>
<ul>
<li>当两个或多个对象互相以强引用方式引用对方时，就形成了循环引用。即使程序中不再有“外部”引用，GC 也会认为它们互相“还活着”，从而永远不会回收，造成内存泄漏。</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> A = &#123;&#125;</span><br><span class="line"><span class="keyword">local</span> B = &#123;&#125;</span><br><span class="line">A.other = B</span><br><span class="line">B.other = A</span><br><span class="line"><span class="comment">-- 即使之后 A、B 都不被其他变量引用，GC 也回收不了它们</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">2.弱表打破循环</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">local</span> A = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建一个“值为弱引用”的表 weakTable</span></span><br><span class="line"><span class="keyword">local</span> weakTable = <span class="built_in">setmetatable</span>(&#123;&#125;, &#123; <span class="built_in">__mode</span> = <span class="string">&quot;v&quot;</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> B = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 不直接用 A.other = B，而是把 B 放入弱表</span></span><br><span class="line">weakTable[<span class="number">1</span>] = B</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 通过弱表来访问 B</span></span><br><span class="line">A.other = weakTable[<span class="number">1</span>]</span><br><span class="line"><span class="comment">-- B 仍然可以引用 A（假设这里是强引用）</span></span><br><span class="line">B.other = A</span><br><span class="line"><span class="comment">-- B 如果只被 weakTable 弱引用，外部强引用消失后即可被回收，打破了 A ↔ B 的循环引用</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 此时：</span></span><br><span class="line"><span class="comment">--  1. 如果程序中没有其他对 B 的强引用，只有 weakTable[1]（弱引用）和 A.other（强引用）</span></span><br><span class="line"><span class="comment">--  2. 那么 B 会因为 A.other 的存在保持“活着”</span></span><br><span class="line"><span class="comment">--  3. 但如果改成只通过弱表来访问 B（即不再有 A.other 的强引用），当外部没有任何强引用时，B 就会被回收</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong><font size="3">关键</font></strong></p>
<ul>
<li>弱表存放那个环中的一端，让 GC 能看到“唯一剩下的引用”是弱的，这样就能回收。</li>
<li>真正使用时，通常会让某一方只保留弱引用，而另一方保留强引用。这样当“外部”强引用消失后，剩下的那一端因为只有弱引用，也能被正确回收，断开循环。</li>
</ul>
<p><strong><font size="3">弱引用表小结</font></strong></p>
<ul>
<li>弱引用表：通过 __mode &#x3D; “k”&#x2F;“v”&#x2F;“kv” 控制键或值是否为弱引用，让 GC 在对象仅被弱表引用时也能回收它。</li>
<li>缓存场景：常用 __mode &#x3D; “v”，让缓存不阻止结果对象被 GC，自动释放不再需要的缓存数据。</li>
<li>打破循环：在互相引用的对象环中，引入弱表来存放其中一端，保证在外部强引用消失后，环内对象能够被 GC 正确回收。</li>
</ul>
<p><strong><font size="4">终结器（Finalizers）</font></strong></p>
<p><strong><font size="3">什么是终结器</font></strong></p>
<ul>
<li>终结器（Finalizer）是垃圾回收器在回收 userdata 时，允许你插入自定义清理逻辑的一种机制。具体来说，当一个 userdata 对象被判定为“不可达”即将被回收时，如果它的元表中定义了 __gc 元方法，这个方法就会被调用一次，让你有机会释放或清理它所持有的外部资源（比如文件句柄、网络连接、C 语言分配的内存等）。</li>
</ul>
<p><strong><font size="3">为什么需要终结器</font></strong></p>
<ul>
<li>Lua 的垃圾回收只会释放 Lua 堆上的内存，对于 userdata（通常是 C&#x2F;C++ 侧分配的内存或资源），GC 本身并不知晓如何正确释放它们。加入终结器后，你可以在 Lua 层面告诉 GC “回收我之前，请先执行这里的清理工作”。</li>
</ul>
<p><strong><font size="3">工作流程</font></strong></p>
<p>1.创建 userdata 并设置元表</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 1) newproxy(true) 创建一个带元表的 userdata</span></span><br><span class="line"><span class="keyword">local</span> u = newproxy(<span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2) 定义含 __gc 的元方法</span></span><br><span class="line"><span class="keyword">local</span> mt = &#123;</span><br><span class="line">  <span class="built_in">__gc</span> = <span class="function"><span class="keyword">function</span><span class="params">(self)</span></span></span><br><span class="line">    <span class="comment">-- 释放外部资源的逻辑</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3) 把元方法关联到 userdata</span></span><br><span class="line"><span class="built_in">debug</span>.<span class="built_in">setmetatable</span>(u, mt)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>2.触发垃圾回收</p>
<ul>
<li>当 u 没有任何强引用时（例如所有引用都离开了作用域或显式赋 nil），下一次 GC 识别到它是“白色”且不可达，就会：</li>
<li>先将它加入“终结队列”（finalization queue），而不是立即释放；</li>
<li>在标记-清除过程结束后，按照队列顺序调用每个对象的 __gc 方法；</li>
<li>最后才真正释放 userdata 占用的内存。</li>
</ul>
<p><strong><font size="3">注意事项</font></strong></p>
<ul>
<li>执行时机：所有终结器会在本轮 GC 结束后统一执行，不保证在某一行代码后马上执行；</li>
<li>一次性：每个 userdata 的 __gc 方法只会被调用一次；</li>
<li>引用恢复：在终结器中，如果你给自己重新创建了某个强引用（例如把自己赋值到一个全局表），那么 GC 会检测到它“又活过来了”，不再回收——这可以用来实现某些延迟销毁或对象池逻辑；</li>
<li>避免循环：终结器自身又引用其它对象时，也可能导致循环引用，所以通常只在真正需要释放外部资源时才使用。</li>
</ul>
<p><strong><font size="3">终结器示例场景</font></strong></p>
<ul>
<li>假设你在 C 模块中创建了一个文件句柄 FILE* 并把它包装成一个 Lua userdata，在 Lua 层就可以这样写终结器来保证文件最终被 fclose()：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 假设 c_open 返回一个 userdata 包含 FILE* 指针</span></span><br><span class="line"><span class="keyword">local</span> u = c_open(<span class="string">&quot;data.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 设置元表让 __gc 调用 fclose</span></span><br><span class="line"><span class="keyword">local</span> mt = &#123;</span><br><span class="line">  <span class="built_in">__gc</span> = <span class="function"><span class="keyword">function</span><span class="params">(self)</span></span></span><br><span class="line">    c_close(<span class="built_in">self</span>)   <span class="comment">-- C 函数，内部调用 fclose</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">debug</span>.<span class="built_in">setmetatable</span>(u, mt)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用 u 后不用显式调用 c_close，离开作用域后 GC 会自动触发终结器</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>这样，无论你有没有显式调用 c_close(u)，在 Lua 对象不再被引用时，GC 都会自动帮你把文件关闭，不留资源泄漏。</li>
</ul>
<p><strong><font size="3">终结器和析构函数的区别</font></strong></p>
<ul>
<li>Lua 的终结器在用法上和面向对象语言里的析构函数（destructor）很类似，都是“对象要被销毁前自动调用清理逻辑”。但也有几个关键区别：</li>
</ul>
<p>1.非确定性调用时机</p>
<ul>
<li>析构函数通常在对象生命周期结束、明确 delete 或超出作用域时立即执行。</li>
<li>Lua 的 __gc 终结器在下一次垃圾回收周期执行时才会被调用，不保证立即。</li>
</ul>
<p>2.只针对 userdata</p>
<ul>
<li>大多数语言的析构函数作用于所有对象。</li>
<li>Lua 的终结器机制只对 userdata 生效，用来释放 C 侧资源；Lua 表、函数等纯 Lua 对象没有 __gc。</li>
</ul>
<p>3.可复活（Resurrection）</p>
<ul>
<li>在终结器中，如果你给自己重建了一个强引用，Lua 会取消对它的回收——它“复活”了。</li>
<li>这在传统析构函数中较少见（大多数析构函数执行后对象就彻底销毁）。</li>
</ul>
<p>4.一次性调用</p>
<ul>
<li>每个 userdata 的 __gc 终结器只会执行一次，和大多数语言析构函数也是一次的性质一致。</li>
</ul>
<p>5.作用范围</p>
<ul>
<li>析构函数可以往往结合语言的类型系统，在对象销毁前自动调用。</li>
<li>Lua __gc 仅在 GC 清扫 userdata 时触发，不影响表、函数等。</li>
</ul>
<p><strong><font size="4">垃圾回收方法</font></strong></p>
<ul>
<li>垃圾回收相关方法 collectgarbage(“命令”) 通过传入不同命令进行不同操作</li>
</ul>
<p><strong><font size="3">collectgarbage(“count”) 获取当前lua占用的内存数 以KB为单位 用返回的内存数*1024可以得到具体的内存占用字节数</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">collectgarbage</span>(<span class="string">&quot;count&quot;</span>)) <span class="comment">-- 20.8671875</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">collectgarbage(“collect”) 进行垃圾回收 理解有点像C#的 GC</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">collectgarbage</span>(<span class="string">&quot;collect&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">collectgarbage</span>(<span class="string">&quot;count&quot;</span>))<span class="comment">-- 19.771484375 少占用了一些内存</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font size="3">其他垃圾回收方法</font></strong></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 运行一次完整 GC</span></span><br><span class="line"><span class="built_in">collectgarbage</span>(<span class="string">&quot;collect&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询当前已用内存（KB）</span></span><br><span class="line"><span class="keyword">local</span> used = <span class="built_in">collectgarbage</span>(<span class="string">&quot;count&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 设置 pause（默认 200），控制下一次完整 GC 的触发阈值</span></span><br><span class="line"><span class="built_in">collectgarbage</span>(<span class="string">&quot;setpause&quot;</span>, <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 设置 stepmul（默认 200），控制增量步长大小</span></span><br><span class="line"><span class="built_in">collectgarbage</span>(<span class="string">&quot;setstepmul&quot;</span>, <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 执行一次增量回收步（参数越大，本步工作量越大）</span></span><br><span class="line"><span class="built_in">collectgarbage</span>(<span class="string">&quot;step&quot;</span>, <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 停止或重启垃圾回收</span></span><br><span class="line"><span class="built_in">collectgarbage</span>(<span class="string">&quot;stop&quot;</span>)</span><br><span class="line"><span class="built_in">collectgarbage</span>(<span class="string">&quot;restart&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>pause：内存使用量增至上次回收时的 pause%（默认 200%）才触发下一轮完整 GC。</li>
<li>stepmul：增量 GC 的速度为分配速度的 stepmul 倍（默认 200）。</li>
<li>通过合理调整这两个参数，可在内存占用和停顿时间间取得平衡。</li>
</ul>
<p><strong><font size="3">简单感受垃圾回收</font></strong></p>
<ul>
<li>把lua对象置空 内存占用变小</li>
<li>lua中的垃圾回收机制和C#中垃圾回收机制很类似 切断引用就会变成垃圾</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">test = &#123;id = <span class="number">1</span>, name = <span class="string">&quot;123123123123123123&quot;</span>,age =<span class="number">10</span>,&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">collectgarbage</span>(<span class="string">&quot;count&quot;</span>)) <span class="comment">--19.9560546875 多占用了些内存</span></span><br><span class="line">test = <span class="literal">nil</span></span><br><span class="line"><span class="built_in">collectgarbage</span>(<span class="string">&quot;collect&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">collectgarbage</span>(<span class="string">&quot;count&quot;</span>))<span class="comment">-- 19.771484375 回收了&#123;id = 1, name = &quot;123123123123123123&quot;,age =10,&#125; 少占用了一些内存</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong><font size="4">什么时候手动垃圾回收？</font></strong></p>
<ul>
<li>lua中有自动定时进行垃圾回收的方法</li>
<li>但是在Unity中热更新开发 尽量不要去用自动垃圾回收 以免产生性能问题</li>
<li>建议过场景或某些情况下手动管理垃圾回收</li>
</ul>
<p><strong><font size="4">总结</font></strong></p>
<ul>
<li><p>Lua 垃圾回收从 5.1 的增量式三色标记-清除演进到 5.4 的分代式回收，既兼顾低停顿，又优化短命对象的处理。</p>
</li>
<li><p>三色标记机制将对象分为白、灰、黑三种状态：<br>白色：未检查、潜在垃圾；<br>灰色：已可达、待扫描其子引用；<br>黑色：自身及子对象均已扫描、安全保留。</p>
</li>
<li><p>分代回收将“新生代”对象高频回收、“老生代”对象低频处理，通过晋升策略减少对长寿对象的重复扫描。</p>
</li>
<li><p>弱引用表（__mode&#x3D;”k”|”v”|”kv”）让缓存或循环引用的一端不阻止 GC，自动释放不再需要的对象，避免内存泄漏。</p>
</li>
<li><p>终结器（__gc 元方法）为 userdata 提供析构式清理入口，在对象回收前执行自定义逻辑，确保外部资源（文件、网络、C 内存等）得到正确释放。</p>
</li>
<li><p>collectgarbage() 系列接口允许：<br>统计内存（”count”）、触发完整回收（”collect”）；<br>调节回收阈值（”setpause”）与步长（”setstepmul”）；<br>手动步进（”step”）、暂停&#x2F;重启 GC（”stop”&#x2F;“restart”）。</p>
</li>
<li><p>在性能敏感场景（如游戏关键帧或热更新逻辑）建议结合手动触发以控制停顿。</p>
</li>
<li><p>以上机制协同作用，使 Lua 能在保持简洁“零管理”语义的同时，为高实时性应用提供可控、高效的内存回收支持。</p>
</li>
</ul>
<h2 id="深拷贝"><a href="#深拷贝" class="headerlink" title="深拷贝"></a>深拷贝</h2><p><strong><font size="4">什么是深拷贝？</font></strong></p>
<p><strong><font size="3">在Lua中，使用赋值运算符”&#x3D;”进行拷贝的时候，分两种情况：</font></strong></p>
<ul>
<li>1.string、number、boolean这些基本类型，会进行复制，会创建一个新对象，拷贝出来的对象和原来的互不影响</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">local</span> num1 = <span class="number">5</span></span><br><span class="line"><span class="keyword">local</span> num2 = num1</span><br><span class="line">num2 = <span class="number">10</span></span><br><span class="line"><span class="built_in">print</span>(num1) <span class="comment">-- 5</span></span><br><span class="line"><span class="built_in">print</span>(num2) <span class="comment">-- 10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> str1 = <span class="string">&quot;test123&quot;</span></span><br><span class="line"><span class="keyword">local</span> str2 = str1</span><br><span class="line">str2 = <span class="string">&quot;奥特曼&quot;</span></span><br><span class="line"><span class="built_in">print</span>(str1) <span class="comment">-- test123</span></span><br><span class="line"><span class="built_in">print</span>(str2) <span class="comment">-- 奥特曼</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>2.table类型，是直接进行的引用，拷贝出来的对象和原来是同一个对象，改一处另一处也会变化</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">local</span> tbl = &#123; x = <span class="number">1</span>, y = <span class="number">2</span>, z = <span class="number">3</span> &#125;</span><br><span class="line"><span class="keyword">local</span> tb2 = tbl</span><br><span class="line">tb2.x = <span class="number">4</span></span><br><span class="line"><span class="built_in">print</span>(tbl.x) <span class="comment">-- 4</span></span><br><span class="line"><span class="built_in">print</span>(tb2.x) <span class="comment">-- 4</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>因此，一般我们提到Lua中的深拷贝，一般都是希望对table类型的变量实现深拷贝。即拷贝后的内容变化，不会影响原来的内容。而Lua中并没有提供这样的api，因此我们一般会自己封装一个函数。</li>
</ul>
<p><strong><font size="4">如何进行深拷贝？</font></strong></p>
<ul>
<li>进行table深拷贝整体的封装思路就是递归地遍历表的每一个元素，并且在遇到子表时，对子表也进行深拷贝。这样可以确保拷贝后的新表与原表完全独立，任何对新表的修改都不会影响到原表。</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clone</span><span class="params">(object)</span></span></span><br><span class="line">    <span class="comment">-- 记录已经拷贝过的表，防止循环引用</span></span><br><span class="line">    <span class="comment">-- 有可能表自己引用自己，如果不记录有可能无限递归</span></span><br><span class="line">    <span class="keyword">local</span> lookup_table = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 递归拷贝函数</span></span><br><span class="line">    <span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">_copy</span><span class="params">(object)</span></span></span><br><span class="line">    </span><br><span class="line">        <span class="comment">-- 如果遇到的不是表则直接返回这个值(比如nil或者基本类型)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(object) ~= <span class="string">&quot;table&quot;</span> <span class="keyword">then</span></span><br><span class="line">            <span class="keyword">return</span> object</span><br><span class="line"></span><br><span class="line">        <span class="comment">-- 如果在拷贝过的表中找到该对象，说明已经拷贝过，直接返回拷贝过的表</span></span><br><span class="line">        <span class="keyword">elseif</span> lookup_table[object] <span class="keyword">then</span></span><br><span class="line">            <span class="keyword">return</span> lookup_table[object]</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">-- 创建新表</span></span><br><span class="line">        <span class="keyword">local</span> new_table = &#123;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">-- 记录这个新表 表明object这个表已经拷贝过</span></span><br><span class="line">        lookup_table[object] = new_table</span><br><span class="line"></span><br><span class="line">        <span class="comment">-- 递归拷贝每个键值对 对每个键值对都调用_copy拷贝</span></span><br><span class="line">        <span class="comment">-- 之所以对键也调用_copy函数，是因为键也可能是一个表</span></span><br><span class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> <span class="built_in">pairs</span>(object) <span class="keyword">do</span></span><br><span class="line">            new_table[_copy(key)] = _copy(value)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">-- 为拷贝表设置与原来的表相同的元表</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">setmetatable</span>(new_table, <span class="built_in">getmetatable</span>(object))</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> _copy(object)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> tb3 = &#123; x = <span class="number">1</span>, y = <span class="number">2</span>, z = <span class="number">3</span> &#125;</span><br><span class="line"><span class="keyword">local</span> tb4 = clone(tb3)</span><br><span class="line">tb4.x = <span class="number">4</span></span><br><span class="line"><span class="built_in">print</span>(tb3.x) <span class="comment">-- 1</span></span><br><span class="line"><span class="built_in">print</span>(tb4.x) <span class="comment">-- 4</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>其中不太好理解的代码为：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 递归拷贝每个键值对 对每个键值对都调用_copy拷贝</span></span><br><span class="line"><span class="comment">-- 之所以对键也调用_copy函数，是因为键也可能是一个表</span></span><br><span class="line"><span class="keyword">for</span> key, value <span class="keyword">in</span> <span class="built_in">pairs</span>(object) <span class="keyword">do</span></span><br><span class="line">    new_table[_copy(key)] = _copy(value)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>我们举个例子来理解这里的代码：</li>
</ul>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">local</span> original = &#123;</span><br><span class="line">    a = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> &#125;,</span><br><span class="line">    b = <span class="string">&quot;string&quot;</span>,</span><br><span class="line">    c = <span class="number">42</span>,</span><br><span class="line">    d = &#123; x = <span class="number">1</span>, y = <span class="number">2</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> copy = clone(original)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>对于键a，值{1,2,3}，调用_copy(a)返回a本身，调用_copy({1,2,3})会递归地创建一个新表{1,2,3}</p>
</li>
<li><p>对于键b，值”string”，调用_copy(b)返回b本身，调用_copy(“string”)会返回”string”</p>
</li>
<li><p>对于键c，值42，调用_copy(c)返回c本身，调用_copy(42)会返回42</p>
</li>
<li><p>对于键d，值{x&#x3D;1,y&#x3D;2}，调用_copy(d)返回d本身，调用_copy({x&#x3D;1,y&#x3D;2})会递归地创建一个新表{x&#x3D;1,y&#x3D;2}</p>
</li>
<li><p>每次递归调用_copy函数时，都会对原表中的键和值进行深拷贝，并将结果插入到新表”new_table”中。这样就确保了新表和原表之间完全独立。</p>
</li>
</ul>

</article>
    
    

</div>
<div class="trm-post-next-prev row">
    <div class="col-lg-12">
        <!-- title -->
        <h5 class="trm-title-with-divider">
            其他文章
            <span data-number="02"></span>
        </h5>
    </div>
    
    
        <div class="col-lg-6">
    <div class="trm-blog-card trm-scroll-animation">
        <a href="/L_Study.github.io/2025/08/29/Java/" class="trm-cover-frame trm-anima-link">
            
            
                <img alt="cover" class="no-fancybox" src="/L_Study.github.io/img/block.jpg">
            
        </a>
        
        <div class="trm-card-descr">
            <div class="trm-label trm-category trm-mb-20">
                <a href=" /L_Study.github.io/categories/Java/">
                    Java
                </a>
            </div>
            <h5>
                <a href="/L_Study.github.io/2025/08/29/Java/" class="trm-anima-link">
                    Java
                </a>
            </h5>
            <div class="trm-divider trm-mb-20 trm-mt-20"></div>
            <ul class="trm-card-data trm-label">
                <li>25/08/29</li>
                <li>21:50</li>
                
                
            </ul>
        </div>
    </div>
</div>
    
</div>

    



                    <div class="trm-divider footer-divider"></div>

                    <!-- footer -->
                    <footer class="trm-footer-card trm-scroll-animation">

    

    

    
        <div class="trm-footer-item">
            <span>
                由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v7.3.0
            </span>
            <span class="footer-separator" data-separator=" | "></span>
            <span> 
                主题 - 
                <a rel="noopener" href='https://github.com/MaLuns/hexo-theme-async' target='_blank'>Async</a>
                v2.2.4
            </span>
        </div>
      

     

     
</footer>
                    <!-- footer end -->

                </div>
            </div>
        </div>
    </div>
</div>
            <!-- body end -->

            

    <div id="post-toc" class="trm-post-toc">
      <div class="trm-post-toc-header">
        目录导航
				<span id="post-toc-top">
					置顶
				</span>
      </div>
      <div class="trm-post-toc-content">
        <ol class="trm-toc"><li class="trm-toc-item trm-toc-level-1" title="Lua"><a rel="nofollow" class="trm-toc-link" href="#Lua"><span class="trm-toc-number">1.</span> <span class="trm-toc-text">Lua</span></a><ol class="trm-toc-child"><li class="trm-toc-item trm-toc-level-2" title="Lua语法知识概述"><a rel="nofollow" class="trm-toc-link" href="#Lua语法知识概述"><span class="trm-toc-number">1.1.</span> <span class="trm-toc-text">Lua语法知识概述</span></a></li><li class="trm-toc-item trm-toc-level-2" title="开发环境搭建"><a rel="nofollow" class="trm-toc-link" href="#开发环境搭建"><span class="trm-toc-number">1.2.</span> <span class="trm-toc-text">开发环境搭建</span></a></li><li class="trm-toc-item trm-toc-level-2" title="分组、注释和打印"><a rel="nofollow" class="trm-toc-link" href="#分组、注释和打印"><span class="trm-toc-number">1.3.</span> <span class="trm-toc-text">分组、注释和打印</span></a></li><li class="trm-toc-item trm-toc-level-2" title="简单类型变量"><a rel="nofollow" class="trm-toc-link" href="#简单类型变量"><span class="trm-toc-number">1.4.</span> <span class="trm-toc-text">简单类型变量</span></a></li><li class="trm-toc-item trm-toc-level-2" title="字符串操作"><a rel="nofollow" class="trm-toc-link" href="#字符串操作"><span class="trm-toc-number">1.5.</span> <span class="trm-toc-text">字符串操作</span></a></li><li class="trm-toc-item trm-toc-level-2" title="运算符"><a rel="nofollow" class="trm-toc-link" href="#运算符"><span class="trm-toc-number">1.6.</span> <span class="trm-toc-text">运算符</span></a></li><li class="trm-toc-item trm-toc-level-2" title="条件分支语句"><a rel="nofollow" class="trm-toc-link" href="#条件分支语句"><span class="trm-toc-number">1.7.</span> <span class="trm-toc-text">条件分支语句</span></a></li><li class="trm-toc-item trm-toc-level-2" title="循环语句"><a rel="nofollow" class="trm-toc-link" href="#循环语句"><span class="trm-toc-number">1.8.</span> <span class="trm-toc-text">循环语句</span></a></li><li class="trm-toc-item trm-toc-level-2" title="函数"><a rel="nofollow" class="trm-toc-link" href="#函数"><span class="trm-toc-number">1.9.</span> <span class="trm-toc-text">函数</span></a></li><li class="trm-toc-item trm-toc-level-2" title="表"><a rel="nofollow" class="trm-toc-link" href="#表"><span class="trm-toc-number">1.10.</span> <span class="trm-toc-text">表</span></a></li><li class="trm-toc-item trm-toc-level-2" title="多脚本"><a rel="nofollow" class="trm-toc-link" href="#多脚本"><span class="trm-toc-number">1.11.</span> <span class="trm-toc-text">多脚本</span></a></li><li class="trm-toc-item trm-toc-level-2" title="特殊语法"><a rel="nofollow" class="trm-toc-link" href="#特殊语法"><span class="trm-toc-number">1.12.</span> <span class="trm-toc-text">特殊语法</span></a></li><li class="trm-toc-item trm-toc-level-2" title="协同程序"><a rel="nofollow" class="trm-toc-link" href="#协同程序"><span class="trm-toc-number">1.13.</span> <span class="trm-toc-text">协同程序</span></a></li><li class="trm-toc-item trm-toc-level-2" title="元表"><a rel="nofollow" class="trm-toc-link" href="#元表"><span class="trm-toc-number">1.14.</span> <span class="trm-toc-text">元表</span></a></li><li class="trm-toc-item trm-toc-level-2" title="面向对象"><a rel="nofollow" class="trm-toc-link" href="#面向对象"><span class="trm-toc-number">1.15.</span> <span class="trm-toc-text">面向对象</span></a></li><li class="trm-toc-item trm-toc-level-2" title="自带库"><a rel="nofollow" class="trm-toc-link" href="#自带库"><span class="trm-toc-number">1.16.</span> <span class="trm-toc-text">自带库</span></a></li><li class="trm-toc-item trm-toc-level-2" title="垃圾回收"><a rel="nofollow" class="trm-toc-link" href="#垃圾回收"><span class="trm-toc-number">1.17.</span> <span class="trm-toc-text">垃圾回收</span></a></li><li class="trm-toc-item trm-toc-level-2" title="深拷贝"><a rel="nofollow" class="trm-toc-link" href="#深拷贝"><span class="trm-toc-number">1.18.</span> <span class="trm-toc-text">深拷贝</span></a></li></ol></li></ol>
      </div>
    </div>

            
<div class="trm-fixed-container">
    
        <div class="trm-fixed-btn post-toc-btn" data-title="目录">
            <i class="iconfont fas fa-th-list"></i>
        </div>
    
    
        <div class="trm-fixed-btn" data-title="阅读模式" onclick="asyncFun.switchReadMode()">
            <i class="iconfont fas fa-book-reader"></i>
        </div>
    
    
        <div class="trm-fixed-btn hidden-md" data-title="单栏和双栏切换" onclick="asyncFun.switchSingleColumn()">
            <i class="iconfont fas fa-arrows-alt-h"></i>
        </div>
    
    <div id="trm-back-top" class="trm-fixed-btn" data-title="回到顶部">
        <i class="iconfont fas fa-arrow-up"></i>
    </div>
</div>
        </div>
      </div>
      <!-- scroll container end -->
  </div>
  <!-- app wrapper end -->

  
  <!-- Plugin -->




    
    
<script src="https://unpkg.com/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>

    

    
        <script src="/L_Study.github.io/js/plugins/typing.js?v=2.2.4"></script>
    

    

    <!-- 数学公式 -->
    

    <!-- 评论插件 -->
    
        

        
    

		




    <!-- Service Worker -->
    
    <!-- baidu push -->
    


<script id="async-script" src="/L_Study.github.io/js/main.js?v=2.2.4"></script>

<!-- CDN -->


    

    

    



</body>

</html>